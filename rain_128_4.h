#pragma once

#include "gsl-lite.hpp"
#include "types.h"
#include <array>
#include <cstdint>
#include <vector>

namespace RAIN_128_4 {
class Params final {
public:
  constexpr static size_t NUM_SBOXES = 4;
  constexpr static size_t BLOCK_SIZE = 16;
  constexpr static size_t KEY_SIZE = 16;

  // --- ROUND CONSTANTS ---
  // Round 0:
  // 0x1d8a22f87e12e486d8803d990c64569b
  // Round 1:
  // 0xddd0523e2f415ca0a4e2745a5a9f9019
  // Round 2:
  // 0xc20f5c2b8ae8ea01007e82d809a22b5e
  // Round 3:
  // 0x334f34591133bd0a09b0a1d9aae702fc
  constexpr static field::GF2_128 roundconst[4] = {
      {std::array<uint64_t, 2>{0xd8803d990c64569b, 0x1d8a22f87e12e486}},
      {std::array<uint64_t, 2>{0xa4e2745a5a9f9019, 0xddd0523e2f415ca0}},
      {std::array<uint64_t, 2>{0x007e82d809a22b5e, 0xc20f5c2b8ae8ea01}},
      {std::array<uint64_t, 2>{0x09b0a1d9aae702fc, 0x334f34591133bd0a}},
  };

#ifdef INCLUDE_STANDARD_MATRICES
  alignas(32) constexpr static std::array<uint64_t, 2> m1[128] = {
      {{0x4d75dd656e6afbd5, 0x2452638089eb72bd}},
      {{0x630abed90701effe, 0x2b11f7acd82a8721}},
      {{0xd1af3d0c58ee575, 0x9c770b46f09dc0fc}},
      {{0x2b9f193beb441f28, 0x159e5d6a94746fee}},
      {{0x9da21ac72210844e, 0xa33485e7447a97e9}},
      {{0xa150e48c1badbf01, 0xd484e5f3715357dd}},
      {{0xe9a6db1b31160523, 0x77565dc5b82e31c1}},
      {{0x69c5fc2023b00c3a, 0x2b173258b0d15c92}},
      {{0x414b3eec3c2a05a6, 0x617a04e4f7321230}},
      {{0xf5295780e4dfd585, 0x1d6dfefa14263c37}},
      {{0x16639f26b7c119f2, 0x8486a690d5b1dcbf}},
      {{0x7ef53a695d61d3d2, 0x93026fa90cdb0132}},
      {{0x920403f3f832a165, 0x5c283848d98865a1}},
      {{0xaba201fe1c5e9885, 0x3498e0e399ad7a65}},
      {{0xdc5cdeb61a87e795, 0xfe8a99adfb98c435}},
      {{0xb0d0ca47834afc88, 0x11a3ef01be2d82a0}},
      {{0xff7e2334900ce0e6, 0x4759cef58a720337}},
      {{0x29f4dd03302c8ec5, 0x30c109214b7befbc}},
      {{0x1a2bfa2565490de4, 0x9850532b5d3bfead}},
      {{0x99036c013228e90c, 0x71f03968d5252079}},
      {{0x472ecc22e2109812, 0x9829b7414d88ba0e}},
      {{0xf764f0c4f5d1f0a8, 0x3fe4266783124825}},
      {{0xd30bbc437f11b8aa, 0x7ea4e396ff5b87e5}},
      {{0x19299790ef0894dd, 0x35b2bf353fa95890}},
      {{0x24aeeb3ef6a31f15, 0xb8ec95b3672d243f}},
      {{0xdc3f7d592007c9dd, 0x3fc0c5944632b319}},
      {{0xf2dae5d9c04cd000, 0xa46fdd94ac199310}},
      {{0x8c08ae3cb140e812, 0xb417eff20f1aab72}},
      {{0xd6e8f7167253007a, 0xbac19920f0711eaa}},
      {{0xa3a908b297ac8650, 0xc08a19360c3edbaf}},
      {{0x3e9149524d6786ad, 0x29976e0362a47485}},
      {{0x68afe5e72714adfe, 0xf314d69304d9c94}},
      {{0x926c87ac189a5fd7, 0xa119e874af822b26}},
      {{0xdaab28ea097f91ef, 0x529cb07ea1c7d6f4}},
      {{0x1568cef68ebb3349, 0xb5c13500c6c68f29}},
      {{0x82e09d4296e5dd7b, 0x40e3e72c4f34e285}},
      {{0x29f07ab70f71a523, 0x5c4350f9162deea4}},
      {{0xe3dfee0b3f59c603, 0xd6b40375ffc3a7ab}},
      {{0x60f4ed7247d2d1e9, 0xb3ad4a66d062d9c4}},
      {{0x168a0e6d66cc310c, 0x56664b12dbb9f56c}},
      {{0xa77a91097a959e0c, 0x5851490724e512e9}},
      {{0x1e22e1ba12220bfe, 0xd2c75bc7f962b752}},
      {{0xdd317ceb70c7446a, 0xa5fd399db53cb871}},
      {{0xfa6a08bf61138c12, 0xcabe2cb10c0c0170}},
      {{0x9af31ab459057800, 0x793772705ee623f6}},
      {{0x40cfae4320de6a04, 0x4c565e4ffd20fcde}},
      {{0x86c574b43861c1e0, 0xd19c32979259a06a}},
      {{0x8f2b74f7b6b7bccf, 0x5cd326ede660785b}},
      {{0xb83d95bfe4bb9d9e, 0x7a4889ff7032f88a}},
      {{0x527491ec529e8ab8, 0x3b8f751601b45339}},
      {{0xb38481ee488d30f8, 0x6b1b11316ac39956}},
      {{0xea345bc10d82949b, 0xeedf6a269e6c8ea8}},
      {{0xe1d4b7496daf3d1, 0xe31ca7b19eb63a64}},
      {{0xc9019448f989dbca, 0x9f458e8518896535}},
      {{0x3a85d58c04d62325, 0x94da596859abe17f}},
      {{0x2f1c30c138c38ae5, 0xd852768d9385e570}},
      {{0xb34d3203870e25bc, 0xae0ef7f33143cf73}},
      {{0xb414aea30dd128d7, 0xe07b665d4babbcfd}},
      {{0xf10b8502e58246b7, 0x96f999e3a720ef54}},
      {{0x132aeceba9d22750, 0xcaabec350d0b6fca}},
      {{0xb270e34360fc39f4, 0xbfa5141a97bdce18}},
      {{0x33afaf95ecd6818d, 0xd76cb1c93c919209}},
      {{0xf714512392e5bcb4, 0xea0259565bd27b7a}},
      {{0xaaea58305d86cfda, 0xd339a8022aef3931}},
      {{0x16b216b561519be3, 0x3c421b557dcbdacd}},
      {{0x7d34e56601d4d2d8, 0xa981c16b831f27c0}},
      {{0xf30a5d942e9034e9, 0xb3b6ed6cb4411aef}},
      {{0x87a6b0ba9cc33de7, 0x95371fe6e33dfcec}},
      {{0xcb711a86dbda24a6, 0x9bad8648ddcd0f66}},
      {{0xaea51b1522b90193, 0x14f979c757a278a5}},
      {{0x40da640d1ec0a8e7, 0x5779c07782c80219}},
      {{0x7dd9a9305dda0035, 0x2da473fd72e4475d}},
      {{0xe1e9ad1d74433d8b, 0xde7a03080185970}},
      {{0xdf86ed08f131b54b, 0xec05d50a63d14fa}},
      {{0xa46b997241e6719c, 0x174d4bb5d504615f}},
      {{0xcf9824ab6f9bdb79, 0x548a5e0c7a2e5ad6}},
      {{0x2874591834ead2b3, 0x83ce7c2aaed65973}},
      {{0x835bcfc7dc4be5fd, 0x56fd03ff0cb83ef9}},
      {{0x8f1b19fc8f0fd223, 0x1f39c08c582b9c1a}},
      {{0x130399d202fd2fef, 0x23b9ad8ff4883995}},
      {{0x21922765307c81c5, 0xbafd7994974ebe1c}},
      {{0xd3db8450e75f1aff, 0x2ce416a52249af87}},
      {{0xad07ad432c33c032, 0x35dec03cb258ba06}},
      {{0xb4a766084d471cea, 0xc3b664ae78bc3635}},
      {{0x12d3e89c8f3c1c63, 0x5c3fd72c2968d82a}},
      {{0x5223ebe0c15998cb, 0x183d9e3e4e205355}},
      {{0xed8ad69a1102f338, 0x31c3f43409050a1d}},
      {{0x1c5cb8fbe51b7b1e, 0xf2fb6f2c226ca625}},
      {{0x1db3079ffdfac7c7, 0x63bbdd0539990208}},
      {{0x6ca3b68e99d52faf, 0xfcab4cbf33909c18}},
      {{0x6ebcccfd4f18aa69, 0x1422e221d6776b53}},
      {{0x1c257913e7ac248e, 0x2816d6ec8cc9a18e}},
      {{0x9ed46844b4686bd8, 0xe4382c3fb2667cfe}},
      {{0x25f01cc24c60b9d6, 0xe67bbba1240b3edd}},
      {{0xd977ceb2aa5b2c9a, 0x6a785ec5a8423ec}},
      {{0xb91cfab576b9782, 0x7cb04b50fc696afd}},
      {{0x34b35b7682f92fa3, 0x66df09b400290f0c}},
      {{0xc2cc9a757742797f, 0xd49cda35bea20db7}},
      {{0x885e334bb09746f3, 0x503906decadc791b}},
      {{0x9fb3499a42bf7c14, 0xc7730effda8c11e4}},
      {{0x21a55d9a3e272221, 0xc0bbe69e9f84601d}},
      {{0x1b98c0f37a0c1974, 0x25597df943e18c76}},
      {{0x4f6865d09a459de9, 0x67bc4b3d95f9a14c}},
      {{0x54b64c8b7b9afbdc, 0xb6d71927d9c35337}},
      {{0xd3cca02b402a807b, 0xf7c0c9326ccb9756}},
      {{0x273c549c62af387e, 0x45d424e6335268dc}},
      {{0xdaed3d8e0ac31b0, 0x253a26fbbd86b828}},
      {{0xbb62e334a4e9abf3, 0x1e9818f33e1309f0}},
      {{0xd0e388500579e50c, 0x664f4bb2885a679c}},
      {{0x45580fad7b4972da, 0x2d9dad083e9226a4}},
      {{0x8933fdb79dc0c336, 0xd199aacadf4190ce}},
      {{0x36b3e3ffb8149de4, 0xfa1c0d8c0c5e0ab4}},
      {{0xde51aac76fcb4577, 0xcdf75895e6172518}},
      {{0x46d941ba5f51559e, 0xfa51e1646747be6d}},
      {{0xc4f9aa24b7272dd, 0x603f7a08f0a00b08}},
      {{0xb9b87377497e0a70, 0xa5b7bf13ee19865}},
      {{0xbb812fd9f85d73ef, 0x316ec9b093a04369}},
      {{0x7fdc1d3ce34430fc, 0x16cd94ddf32e80cf}},
      {{0xc5e5638f517ce435, 0xc964e1f35214fc7f}},
      {{0x919c250810986141, 0xc2696c1a21de48de}},
      {{0x9eae545d0dd20033, 0x8e41d912088e1800}},
      {{0x347f41612a6bd140, 0xe8401c5e649e3549}},
      {{0xfe6009aab0ad7bfc, 0xcc892fbf5e5edda0}},
      {{0xba9035f0441eaefa, 0x297fd245d1e55cad}},
      {{0x67e26a3b69b86d3a, 0xaf37d341b1b8081b}},
      {{0x5088b21b47805a7e, 0x2652901d4fc888b6}},
      {{0x823f84fb1d50e949, 0xa78f130aa6016041}},
      {{0x22b80efa40314b5b, 0xac61676625b41bf}},
  };
#endif
  alignas(32) constexpr static std::array<uint64_t, 2> m1_transposed[128] = {
      {{0x26d8807f43827265, 0xc1d509570733fbed}},
      {{0x86298e3b98510dd2, 0xb9136b07ebbed379}},
      {{0x77c1a383c38f7317, 0x2477d2aa2b83a4d8}},
      {{0xa12f87ced2e8809a, 0xfc3633c25eeaaf06}},
      {{0xdf1f0a09bb904c87, 0xbd6f6fae70c63ca2}},
      {{0x55c6465ad06515ce, 0x3d79cf77065ef8dd}},
      {{0x9ab4c64fb2871c17, 0xeebdabe6353baa4f}},
      {{0xf7bfc243c2e7ef03, 0xc36acc5fb2bb57f}},
      {{0xb97142df830c5f6f, 0xd693dce3b3c1af29}},
      {{0x8cf223256102482b, 0xac1c689597c2d803}},
      {{0xcd098d39e186c3fe, 0x1843904dcb18a31c}},
      {{0xd2a3bb098b5ea4ab, 0xfc088aeb76ba8949}},
      {{0x503d91cf05f0ae29, 0x2636a6eaa0fa5f0f}},
      {{0x5b54b0948869d027, 0x5cf43e9b7ec0a75c}},
      {{0x843074690e29ca07, 0xf6d7708e11c47c02}},
      {{0xe0bbc97aeefbfa37, 0x4a40d9c0a5657a43}},
      {{0x42a5dd3e53644e22, 0x86133a5dc2aeeb29}},
      {{0xaddbae475300f345, 0xb0d039ec1ce7d98}},
      {{0xf146b58ae603626c, 0xc78867c0a1bc402}},
      {{0x113720a7248fa325, 0x1ed93fa9ddb3f8b0}},
      {{0x3a53a977907032d0, 0xd9de908d47b78ab7}},
      {{0x5001c21e610a19a1, 0x964c1f19b9159620}},
      {{0x7ad064fa5c24ae09, 0x437f7843f32bb5db}},
      {{0xfeffa5cd212046a4, 0x35814e8d0b009cfe}},
      {{0x8f281872e8e48cee, 0x716f70828ffa4e93}},
      {{0x411283fcb1d8c4bb, 0x222722fbcc12c874}},
      {{0xa75980fce1e42f07, 0x69035812bd9e79cc}},
      {{0xaaac513740c07929, 0x531fe0f0671c68dc}},
      {{0xc0b2d729396b7d60, 0x44d2e0f6934133d8}},
      {{0x3ca1eda09bfe17d9, 0x1631aeb659871b25}},
      {{0xb4271dc055f41a0d, 0xb87f27aaadaa2f91}},
      {{0x6d31800c2db1960c, 0x430cc455bb26218}},
      {{0x7b89adb0864e985b, 0x7359e1a68d852961}},
      {{0x5f05ae7ef152f458, 0xf44fc1bdebc4ac1a}},
      {{0x2057d8959925e531, 0x169ea0317116177}},
      {{0x8670fa30f00296a, 0xf5f2a79c87d85b48}},
      {{0xa011da547f81704e, 0xf93ade7b4dd2d5ad}},
      {{0xca17ded7a9157d89, 0xde2ee923c4a14c8b}},
      {{0x18bea4cec660b917, 0xcb19946734a7e402}},
      {{0x2acfde17a4a07336, 0xcc57e6f8e7f0e81d}},
      {{0x745f0349d783364d, 0xefaec5d8925f7a6}},
      {{0x331830b51985df56, 0xb05dac07c3692031}},
      {{0x2e61e4ed9eda47a3, 0xc9b062d0e74f2b47}},
      {{0xaa183cfe6b5ecddb, 0x9435709bfcb4f7b4}},
      {{0xc1ebd51812e64fdf, 0x292c46172ac0d43d}},
      {{0x3b80e6729f6d09a6, 0x38d9c9441abd0bca}},
      {{0xd858c674d73ec2e5, 0x134acef9dc783246}},
      {{0x3e67236d9df6c4e7, 0x6005dd22c6f6a78a}},
      {{0x2571f422e2cc0f89, 0x4257d019cb3ee5b0}},
      {{0xac00bba2875d255e, 0x5304dc8d437fe64d}},
      {{0x63df6061833358c9, 0x43e407965c8c122a}},
      {{0xad91a9a7bfd5430e, 0xe3ae276604c26dc4}},
      {{0x529b15704603c82d, 0xcaabe2adf59378d3}},
      {{0xb80b9f5fb3b72e51, 0xd748ded96f28153b}},
      {{0x9102797d1423cda1, 0x16673946709235d0}},
      {{0xa04470faf502a8d8, 0xb9fa95bbb75b0be9}},
      {{0x6da4853420fb23ff, 0x10f86f78e147eb9e}},
      {{0xf9dedbab74753c0a, 0xdd338b6a9432ea3d}},
      {{0x4290c7845b314e15, 0x1767a6c93fcc4eab}},
      {{0x80f99e12ca8f68dd, 0xd3d4c6cdfc45ab2}},
      {{0x7f471e8756edde10, 0x2fb999a959ba8287}},
      {{0xf7cd0970e523aaea, 0x9e388a11264d15a6}},
      {{0x442a2c6296714bc3, 0x346331c246620bd6}},
      {{0xd72ddd2b3e69f270, 0x4dd9590e504e6f3c}},
      {{0xa362852c636d7673, 0xda7a0096a4eab4e5}},
      {{0x4945f22139110e88, 0xb0e041a61c165e14}},
      {{0x67430dbe177662d, 0xa8eaf3fbf8ef8cbd}},
      {{0x7a4be1a4331e043d, 0x9af75655fb5166cd}},
      {{0xd7e6be028f8b4fa5, 0xb0c19bb6b669ffc0}},
      {{0xc3fa5db7396fff1f, 0xac5aacaad098333c}},
      {{0x4fd4ffc20848207c, 0x42fa4b68f4203f9f}},
      {{0xa09317af0c694fd, 0xaca0fa0af802aa2f}},
      {{0xcde61ae52e43187a, 0x861519cf4c229592}},
      {{0x7d1a133f3e57a13b, 0x16b181e5ef28d7}},
      {{0x1fa822b6d14656ba, 0xe433123328b629a}},
      {{0xdf1da455b8b62688, 0x3dce8e27b657f93d}},
      {{0xe217a7c2f69427f1, 0xf4a458c323dfb2d}},
      {{0xcef1f6b94b1e3249, 0x42433654fc8fa42a}},
      {{0x5de3a0da60a674ad, 0xccd0129494301da9}},
      {{0x37cd66feae56c416, 0x246a45600a974009}},
      {{0xbbe441b295ceaca5, 0xc80b49e1ad42421f}},
      {{0xcb5512672a670b73, 0x87a3bf8234015823}},
      {{0x909a1d1ee108a24c, 0xfe3841c54c91e9a}},
      {{0x9a684c90add6f857, 0xb7a0914da99feb5b}},
      {{0x701344883e674dbc, 0x96c1ba44070c330a}},
      {{0x965bb7d8738fa75b, 0x183c006394b86aa8}},
      {{0xc10cd366904308b9, 0xac8ad3e49c9710d5}},
      {{0xf2f611a740907c85, 0x3b9c25fe4b08b0f1}},
      {{0x5fc226ab09fe7521, 0x38b246f00351043b}},
      {{0xd69cd0bd4be3c100, 0xe47b6a3e56a71aea}},
      {{0x3c18bd3d2fdc8f18, 0x660bed52ac21b635}},
      {{0xea7c3aa92cd7f843, 0x2508fd9ec9787811}},
      {{0x71f976f090ccf7ee, 0x1c7c6edad70dccb5}},
      {{0xa505a723d5c0c1e4, 0xd2af2f02b39e9a8d}},
      {{0x4245b2ec535e5536, 0xae6741acc428ccb9}},
      {{0x1498e6e71469f5cf, 0x583554de9c05975e}},
      {{0x2fb5ef30c1b7e870, 0x3c690cea3702a4e3}},
      {{0xd50b63c26964223c, 0xc7c05f9c1228b06a}},
      {{0x4aabe76b26e14156, 0xae2382df5bffeced}},
      {{0x32c1a41a800c5a8a, 0x66a4e47c5abcf896}},
      {{0x5b175cb32fc106a0, 0xa7f91d7f926527c1}},
      {{0xd5d987bb9af6b3a, 0x845a1feb7efe35ce}},
      {{0x6741b273883933fc, 0x9a6a4e2cc80022ff}},
      {{0x25b1ce100f416f73, 0x479de3d6a0be4a8}},
      {{0x655707acbfdec87f, 0x555ab1e1e191a6af}},
      {{0x3b8f2e848f58e87, 0xdc0c545eacb22c99}},
      {{0x1bb2a80ccfb18f7a, 0x86a0a63c5bfa9a1c}},
      {{0xcc692fc1fc8bda4c, 0x79df9ebb3a19e2d}},
      {{0x75c67616359c52ca, 0xfb2d08a229731aa9}},
      {{0xab9adc0f48f8bea3, 0x4ce663034c991a4}},
      {{0x4bca33d9ce45aa6b, 0x19df11728fdd5ee6}},
      {{0xad31000b1fd1e632, 0x397261126d74c156}},
      {{0x9e2e975ddc138286, 0x5daf70bd63f1e57a}},
      {{0x4bceba986c80cdcd, 0xf81d14996fdc190d}},
      {{0x313a7ee24d6006fc, 0xd875b2c3483f359c}},
      {{0xaf5f4c4325117308, 0x4cbcfc7733b5fc70}},
      {{0x86dcfd23c88d21df, 0x380feeffb9bde06c}},
      {{0xbe001ce885f89314, 0x18d5045cf7bbe1fc}},
      {{0x26e9a79c172f0345, 0xabfb13a920c73761}},
      {{0x1c4ace6e73eae428, 0xc4216bd3c3cfbbb6}},
      {{0xb0365445c2a98bda, 0x58516768014cd5de}},
      {{0xfd3f0ae2926148d2, 0xf1aa99c96189f654}},
      {{0x3568a4b48ee1766d, 0x75213febf6166fe9}},
      {{0x59afb910d3745286, 0x9f4ba8008a334393}},
      {{0xb4e3d3f61bfefa6c, 0x32c98686f56c7d}},
      {{0x531f14455fea61d3, 0x7a16b5e1bbc78087}},
      {{0xea9dfbba20495160, 0x6c7d35fb3982840}},
      {{0xfff84e653d144c34, 0x57c3c19a3289101e}},
  };
#ifdef INCLUDE_STANDARD_MATRICES
  alignas(32) constexpr static std::array<uint64_t, 2> m2[128] = {
      {{0x8fd5f164f7172be2, 0xc8715155fd80eda4}},
      {{0x2ade5bf0f93a97ba, 0xfda2e09f11da2a03}},
      {{0x377d625c079e39e6, 0x414eb4e02d287b6d}},
      {{0xd787b4b7dd16b30b, 0x302442834628ca7a}},
      {{0xc4aaf37bbc88ff7f, 0x20307a20a7fb6af7}},
      {{0x31ed51a855ff49d8, 0x85cc47eb254ae011}},
      {{0x5db7030ca7a3c63, 0xb6c1a218140ae64}},
      {{0xf8ba06851b481833, 0x7a67f4f6532e552e}},
      {{0xafe5f2bb8a93b1a, 0x8b6f4459b1c65a34}},
      {{0xe1c8c9afb610ec3f, 0x425aaea1df889810}},
      {{0x3c3e6f536d72f02d, 0x99e59245fadaf3af}},
      {{0xc94eaddead808328, 0x4cfa45fba571ce37}},
      {{0xb8d026d2ad08a731, 0xd8c6112ee0d80db2}},
      {{0xb41dc7adfd191c66, 0x160eb07f38f727fb}},
      {{0x274311a7da3c463e, 0x5727ccfe9a0322b0}},
      {{0xca4aef2987ddc410, 0xabf41ff8d525c8a0}},
      {{0x176a8559eefa087a, 0x88ebb37d1a312ab7}},
      {{0xb048d9bb30766669, 0x9df47c1f21ffc51a}},
      {{0x3f9ae81abab864c3, 0xb3753f407ddf5e51}},
      {{0x62650098078482c6, 0x934664b47c305a41}},
      {{0x7c2926885e220639, 0x26da53a639b88b89}},
      {{0x9de5e5d13749adcc, 0x7fe51a4db5c1722}},
      {{0x7a8f9b40929075df, 0xccd75b57fa26628}},
      {{0x640d6c8f2812096e, 0xea7f5a8d99cf1893}},
      {{0x68d658db8dde61f6, 0x846a9cc632b56bff}},
      {{0x6af67cefff5a2604, 0x246d0e44f045d93c}},
      {{0x75103bab7d89f152, 0x92552d2614f519b6}},
      {{0x80afbe51e07c0831, 0x8d19fde709fe7b3c}},
      {{0x5da51ded2566f7a, 0x68d89d77542aaca5}},
      {{0x3157af762fa6f521, 0xc6acdfc5e0415213}},
      {{0xc4c3e0efa94eb25b, 0x5499575c045c826e}},
      {{0xd6e3101675afc243, 0x4b8db25bea3d9b9}},
      {{0xf3448cc0064d24c9, 0x8bc9757a1304d658}},
      {{0xcb75b1cacdccdf8, 0x5219f54bcc3131aa}},
      {{0xa36b142615896622, 0x9d678e1064a593b5}},
      {{0x510b1440bd7441f9, 0x1bdf97f3955fd7c5}},
      {{0x4ca1f4820dc72620, 0xb74ded92c2739d26}},
      {{0x903ac5495ff62ef7, 0x40b271ea2ee66ea9}},
      {{0x8806f8145fb2e9d9, 0x438f43b81d06e88f}},
      {{0x9e85d6464ab147a9, 0x55d02c6287c747e5}},
      {{0x447a3cef85a1eb74, 0xeb89b51b4ecd79f6}},
      {{0x5ecb23d81c06eaa0, 0xb27741007f8cf4aa}},
      {{0x4940877e4fd7de6c, 0x5805383f753b27b4}},
      {{0x594ed44ac3ae2706, 0x93ac86c0931843a}},
      {{0xcffaab61a0f1e97d, 0xafc0958c75a23215}},
      {{0xc0cf4de8e8492140, 0x1ef0699ec148c1cb}},
      {{0xfe884210ab1c73d7, 0x6cadee633302393b}},
      {{0x666101c625ecfb14, 0x6e0cf4a90c4b1a26}},
      {{0x5e0423f885a7c0ed, 0xe43c6b518d6a4a41}},
      {{0x69f557964bb91322, 0xc94b87823e0c21bb}},
      {{0x2df520d03321df1c, 0x811ebe0c20556024}},
      {{0xc27f89d7e64a944f, 0xa084f3e72e8d54a3}},
      {{0x74c06a221bebf41a, 0xe5cad48002fef883}},
      {{0x8d1b14659a9aab13, 0xd67677171c2f7013}},
      {{0x2afa8acd7b083357, 0xf3fab520a04e3c37}},
      {{0x76594af2cab1a34c, 0xf779df5133763d8c}},
      {{0xb6a977d1a857535, 0x1a1e92dc4447c853}},
      {{0x6dfc7e2442ba6370, 0xc1e15152e8a1b19e}},
      {{0x5735b249e5dcd128, 0x390490fefd6354d5}},
      {{0xf8473e2b8c85bc1a, 0x146e00fe31ad9829}},
      {{0x121d0587b2ccd392, 0x10f16e2b103c5797}},
      {{0xdbb0e38c9f72688, 0x6cda1f722b519ab5}},
      {{0xd9fc28a17fd2ad36, 0x9739bef1da1954bf}},
      {{0xbeef91ff9e32e0c2, 0xdb21c72ddb75a74f}},
      {{0x3ec278000c6c9de6, 0x937dcabe2bc61d64}},
      {{0xff83fbbcdadcb7e8, 0x66ff0c19521ca269}},
      {{0xbf04550988454080, 0x2c52e09f68017665}},
      {{0x8af5bbd2c4cbda04, 0xe700a7057a6fe62}},
      {{0x4cd963c1061b8644, 0x414755d5ff3c5843}},
      {{0x70312536a8b6fa52, 0xae4f573169ffc0c}},
      {{0x2461abc3da23e7d1, 0x6d91bbd331e53fa8}},
      {{0x889dd65188f8bd7, 0x2af1947baa0e178b}},
      {{0x8974c8d288d88385, 0x6491de0edfabbf0c}},
      {{0xecbb4fd2a8af255f, 0x40aa330fe3f7b600}},
      {{0xd1c7785558eb63c0, 0x757f2a0009884711}},
      {{0x4086997c9f85ec89, 0xfd4e5764cc84fe88}},
      {{0xcdbcc5c375423eaa, 0xbbcb410f2e7a3748}},
      {{0x698cbaaa5bf5963c, 0x989a79f9dd4699b5}},
      {{0xc29f9a40f8dba8ff, 0x3bebcd7cfff8ce29}},
      {{0x9c7ae8569d6b18c4, 0xe1e27ae21a3987c1}},
      {{0xaa15853016f3c8f1, 0xc414c53905bc5c23}},
      {{0xc324369627bd5c64, 0xb8936f7a553284ea}},
      {{0x3f6c88e2d0e12500, 0x8202c4ba12d6284}},
      {{0xc865b709e537a41, 0xb226a13cf9d0c452}},
      {{0x948dfa591660a092, 0x4bb13125a0956010}},
      {{0x23b4d1cd8358709f, 0x2361630a75371243}},
      {{0x4716b13cbfbc7341, 0x5e52499e87093246}},
      {{0x6d0763e85443813d, 0x4d7a5ce556806b8e}},
      {{0xefd95b6fde767a39, 0xe412d6490f9b5011}},
      {{0x4359c9d5e803f5, 0xbf47efcbb2d0cd53}},
      {{0x33cb06e2aca9f5b4, 0xf45c229cfe6ea51f}},
      {{0x283adadf640f7b96, 0x1415f401bb4b5b8b}},
      {{0xe9646d30ba24dd34, 0xfe214bbce04e7c3d}},
      {{0x822e6ab4d36b573f, 0x320218d36d5100c8}},
      {{0xee578a057367ac42, 0x57446f43c7c6df7f}},
      {{0xac90c9f971b21e98, 0x110852b80709a7c}},
      {{0x7ccb7d0191f3982, 0xc44ec8ceed8da3db}},
      {{0xce8987bc288c131f, 0xc3b1bb27304f4f53}},
      {{0xdb5cc00b74c70de8, 0x3a6975229e3bacfc}},
      {{0x6adc48d8d62d062f, 0x9a026b1cddde9729}},
      {{0xa448839f3f64c76d, 0x964447a516df9645}},
      {{0x8f49b3290b262211, 0x672688b5b62ac3e7}},
      {{0xe354ff0ccedd39d0, 0xbccbc686e3ff7f5b}},
      {{0xa9e67dd902b8fc26, 0x188099781c0a86cc}},
      {{0x6f47eff644142c67, 0xac256641b9c08f73}},
      {{0x332cef629985691d, 0x4bdd91cfc96a8a3}},
      {{0xe384cacb94426162, 0x8255380786658edf}},
      {{0x4d15194518a0b31c, 0xab8b0198995efe03}},
      {{0x34dd4f7fcb1a8960, 0xe0d93c89fefe7918}},
      {{0x854ecc6e67ebe577, 0xd40d738796a11ea1}},
      {{0x3f307f599002cd9c, 0x6d77e43e5f638232}},
      {{0xd7eedae2059053ac, 0x630e2cac94a9ff05}},
      {{0x3ce653940d6cf544, 0xc409c429c2a97638}},
      {{0xf5f38f1f3c2c9313, 0xc98b73a01398964}},
      {{0xb2d025af3bea881b, 0x5cb8ed0549cc487e}},
      {{0xcf56f52c8f3c9929, 0x3bab9f288410c9da}},
      {{0x4cfac95a1a4b476e, 0x25aba7febe0fb7ce}},
      {{0x80254d61bcb59aa9, 0x787cee4c42410389}},
      {{0x8dc27f1c5660af05, 0xb9131f7f42c3355d}},
      {{0xc183cd3775f76115, 0x2c06a1a97f0e9e84}},
      {{0xbbaa1cfcbee8e57c, 0x301f7a52aa4fa6d0}},
      {{0x163679b17d1ae27, 0x9da7ac0a50bf679f}},
      {{0xa8810780c840d84, 0x75200d3929b6873a}},
      {{0xdd2a6e9f06da68d0, 0xbed8cb31247e9d7b}},
      {{0x7a6f1a1beff0cb74, 0x15ca34b786e85317}},
      {{0x8ac539059517380b, 0x1c1fe72adb6d9503}},
      {{0xab132852b3a375f5, 0x7352bedc1a775087}},
      {{0x207d3cac2cc6ed0f, 0x7aa5df7c7b53687a}},
  };
#endif
  alignas(32) constexpr static std::array<uint64_t, 2> m2_transposed[128] = {
      {{0x16950e9e85616d8, 0xe2ee233a23e94bc0}},
      {{0xd87a4824d5cd63df, 0xa216258b683052a1}},
      {{0x41cddd2003e86614, 0xd7d1eb9a3ea2e399}},
      {{0x2c9d14cb50f34f3a, 0xa13cca1ea1a07a02}},
      {{0x5b74d16a5d51d3b2, 0x59866a62bfb162e0}},
      {{0x470317be39937ed7, 0x5338b59c37837003}},
      {{0x82c9756bd5ef2075, 0x59113554424bc6f3}},
      {{0xb00142eb016c0027, 0x4c20c0458e31ddc7}},
      {{0x57e6f9ca35e0193f, 0xd5dbfe573ec407c3}},
      {{0x32e6cfb4d21a591b, 0x1272883aab4835fa}},
      {{0x691c0cb73276f252, 0xc751619cf4063a53}},
      {{0x4824976218a123f5, 0xbe6c53c5d90bd8a9}},
      {{0x1d5ec400644025de, 0x602b88c3bd6ab02b}},
      {{0xebf0fb757766175d, 0xebc12fe14d7c5e62}},
      {{0x9715d7ceb546c630, 0xd991e6903d6b0c6c}},
      {{0xdcbd9742e4289e1a, 0x936f7890549169fb}},
      {{0x299735958420a121, 0x62b0224d6c8feedc}},
      {{0xe2390e70f393046f, 0xe8947425e989d6f8}},
      {{0x3d01ce3bf90ac02d, 0xa4ab037f59422aa7}},
      {{0x167ae807cf25f1f6, 0x91f30cb2e62c79b}},
      {{0xe6a254ea1bc7e66f, 0x3aa891c1816b6132}},
      {{0xa29799e8a8174562, 0x51ef28b8f757a661}},
      {{0x7418b43b5b2384e0, 0x9bd5245463bdf50f}},
      {{0x7fb39df6a54d8934, 0xdfa4aac686476faa}},
      {{0x6457cd7ce728bcaf, 0x728db231e262b800}},
      {{0xd3fe4ce1327dc2c5, 0x5b5c30f8717b2852}},
      {{0xcc09877fa739be3d, 0xbfeba55c0fdb9819}},
      {{0xe9f266fa67957dda, 0x953f1a731548efe7}},
      {{0xd174026c967663bb, 0x63f64e1df3ddfcc2}},
      {{0x544cf00aeea73f13, 0xd1a62016dc425220}},
      {{0x66ca2ce09e11646b, 0x10c0314ceb84744a}},
      {{0xbca9790a5b45fb5b, 0x71285648376ccb6e}},
      {{0xdd6811204fa3e798, 0x3aa65cb4cb3014d4}},
      {{0x989a8d94f7865f18, 0x5a96b7140d06b368}},
      {{0x936a85c6f2806a8d, 0xa9cf395269628ca2}},
      {{0xad412f22579fab34, 0x9f5e74fe8bf02806}},
      {{0xa18f4642b92f1c5e, 0x5fd3519bb85b8f2a}},
      {{0xebb135046602e37b, 0x85acb322b5cd28a2}},
      {{0x85edbfa97b611c17, 0x4530ff898fbcdfd8}},
      {{0xd0cfa31157ba7aaa, 0x8b05859baea6335a}},
      {{0x910bb6223463ef33, 0x22ff5bf393e91afe}},
      {{0x2fd356822c50b596, 0x1a43d7736d9a625a}},
      {{0x3b222dbd2ab1bd88, 0x8bee73c3140312a4}},
      {{0x6ad831432fc68f02, 0xf9f2ffc8fb1cefcb}},
      {{0x8f2209de9f42417b, 0xb549c8e10b7a6c8f}},
      {{0x4e1513506eb49c5d, 0xea4c43e130d2a47b}},
      {{0x29268f253a6a777, 0xaf9f7ccbbb89797}},
      {{0x85481cf16867aa19, 0x9aa777c875f9ca}},
      {{0xbcaea29ee8f8606d, 0xf2a21922479146fa}},
      {{0xa9683b6efb45cdda, 0x5bdba1806ec8ce03}},
      {{0xde0f28c32be82d2f, 0xb029bfcd70ff7d0c}},
      {{0xf3e87b2c18d7aff6, 0x9d10b23f2d14f290}},
      {{0x76ee1122370435c7, 0xc01e584cc961d338}},
      {{0xe74e91368a3905b4, 0x9b33c28038269368}},
      {{0xcbdebf05f32bdb67, 0xb25fb1fd57048559}},
      {{0xe2567292db6413fb, 0x25d7948b85387e9b}},
      {{0x67261c0d34254a6d, 0x4bcaefe515e63506}},
      {{0x95c9d285824dc10f, 0x750cc76f6567400f}},
      {{0xa6b5d392d4b5645d, 0x85bf933c1dc9257}},
      {{0xeb675ed203749d83, 0x7d5949aed98db39f}},
      {{0xdc914aa9a47734ac, 0x1907d20404148427}},
      {{0x8ad6c00527de76a6, 0xd10757d8dda52267}},
      {{0x4e9bff19c7d88a98, 0x189a8d4e51c27e32}},
      {{0xc82870e5c822ba99, 0x69eea4f6f113d70e}},
      {{0xfd7b70ecb19d2c36, 0x7a60af7b5f21e496}},
      {{0xd37aeb5265a33c9a, 0xfe1c4f634eeb0098}},
      {{0xf6c495dc5f010dd5, 0x52d684b4d4c42125}},
      {{0xca826a63cb52248c, 0x8e7d14cdfc8259e2}},
      {{0x77625d05af877b38, 0x9f4d5547d7182400}},
      {{0x684ecfb6df61fddd, 0x8c07632cd003604f}},
      {{0x85012189410c205c, 0x895e05f7e26a901f}},
      {{0x769a27ee9591f411, 0x43b826a52886a8c0}},
      {{0x9282659e8f323485, 0x3e7a916b4e80b5c1}},
      {{0xb00194ad697d6d5e, 0x17b1edfbc8e4dfce}},
      {{0xd4c80eb9106638c1, 0x2fd1adde560bdfed}},
      {{0x29d1c1709f9d9b5f, 0x888ebf46da816979}},
      {{0x7ef8d31faeac0784, 0x78d1b858d9613bfd}},
      {{0x82f6576219416477, 0x83519a4514d41b6e}},
      {{0x553d23e9ab4e8dbd, 0xd20d98625b9d4c3c}},
      {{0xab102a5dd2128e69, 0x2d9acfbdc60aeb2a}},
      {{0xef2c8d9ea787e810, 0xe373e45729748364}},
      {{0x5f1d4f898c665b2, 0xcfd05afe5d2233a9}},
      {{0x99fe03ed4fa6a180, 0x6f941e5b54352afb}},
      {{0x587ba70858b616be, 0x3b9798ff1d45d5b2}},
      {{0xf0940c1a4d3f3c12, 0xce0a1a5ca33bd232}},
      {{0x9eb11c369d5ba89c, 0x7e03f4648427d358}},
      {{0xa5d5a1b86ea63d72, 0xf9645d5afe087241}},
      {{0xa1813a48dd63713, 0x1645b35943994f69}},
      {{0xac817ec908f68bf7, 0xa4864949696f6759}},
      {{0xe09a43b181614698, 0xf1f174744fc0d3bb}},
      {{0x52b97eed44c8a3d, 0x1898f6bd65e37938}},
      {{0xe62b8b6288fd6605, 0xe5945b8d2d08fd95}},
      {{0xdca2564997fde783, 0xe290fbbe0eaae17a}},
      {{0x2ece5624a35e3d35, 0x8d9013633e3c52d5}},
      {{0xc7003716326c9689, 0xa2e5524974aa6b1e}},
      {{0xc641209aa2a0df51, 0x3119bf6dde5c6b90}},
      {{0xd0a9c50ab8c32f6b, 0x1cc53532eb9532f6}},
      {{0x3e2a65bb1d1278aa, 0x33526447e26693e5}},
      {{0x8d2c3c00fffb7483, 0xd074e67b14d85b15}},
      {{0x9d04bd634083f922, 0xe6fbda89976f7387}},
      {{0x6fa1255d504be983, 0xdd524aa8344b60ff}},
      {{0xfc48cce99c79faf4, 0xbcdbc0b6909be8a9}},
      {{0x6f8948ab7b05eda5, 0xc17001816386e8f8}},
      {{0x4d1ab07829f8caae, 0x5090b87136c0a055}},
      {{0xa2eb337bfc759821, 0xacde2a9ed27b7a70}},
      {{0xf1af404ce2958678, 0xe97a215a57228f49}},
      {{0xf0f6d19f7f4ecba4, 0xf67fd154cb8749b2}},
      {{0x70856c94bf86c250, 0xcf6c96ab72c6e54b}},
      {{0x67fc952bf9f7b4d5, 0xd14a36862990abf0}},
      {{0x506de5b30c4f2296, 0x73b6f50e4e3ea664}},
      {{0x92b9ea73e8fa49bb, 0xa925635d5be3f935}},
      {{0xc5ded91eb9016686, 0xeabf42e38b0941e5}},
      {{0xd282475f4ec54581, 0xa3597f461a3255d3}},
      {{0x29760a6c01b97b86, 0x73d8c86923cafe16}},
      {{0xd2dc65c26eef5ec, 0xa3a0e7314e090c33}},
      {{0x69d7c95bfbf12b64, 0x393fba4504807e03}},
      {{0x71e52aaadcb68a11, 0x696656028dd325cf}},
      {{0xdae16a24a3a7cddb, 0x863c432610bcc6ab}},
      {{0x3af2329d17ff9fe5, 0x5820545546e0dcbf}},
      {{0x325871e9f0739c22, 0x9a1e1ac20012f3e2}},
      {{0xc6d619dd082ec566, 0x5658c822c2b0dc51}},
      {{0xc1e0b35b24bce3c0, 0xc8088c3e727850ab}},
      {{0x68b1f094eb726822, 0x3e9763715fc10d4e}},
      {{0xa502fd0d18c39dc3, 0xaaee49cc12d678ec}},
      {{0xdde0269e440e748a, 0xff6c20dc7e4a7c01}},
      {{0x24d9d3101294809a, 0xcdf8d964372addc6}},
      {{0xa2f3c5e270805a87, 0xc425f02355d18f52}},
      {{0xc2ff13152d8f9523, 0xa413d5b170bb801}},
  };
#ifdef INCLUDE_STANDARD_MATRICES
  alignas(32) constexpr static std::array<uint64_t, 2> m3[128] = {
      {{0xe83673690de57f22, 0x301f759f640871d5}},
      {{0xb510eda5f60ae31b, 0x49c3789a9602b9b3}},
      {{0x6d2fe3b1ac8174f1, 0xe7b17317a67372c0}},
      {{0xb8dc7d9205d8267f, 0x1db5d72a495b09aa}},
      {{0xee06b6826f3218d8, 0x7c86a6acbec3e98a}},
      {{0x7265e70cd932483d, 0x1d69fa965f8872c9}},
      {{0x7393b936694ac558, 0xb6fef46dd60f9c67}},
      {{0xd6ed78427f3da0d6, 0xa9980bb983092d84}},
      {{0x223024476351187a, 0xb1b6412488e9e097}},
      {{0x4459ba77fd5ad566, 0x297a45cf0013eb4c}},
      {{0x153ba82287ff96c4, 0x5d4f777cdb0d0c26}},
      {{0xbb280f2078b1a4f9, 0x311e1e032a5b0fd8}},
      {{0x3e42c86daf29c548, 0xefa4fc829fee780}},
      {{0x6f3b0286855219be, 0x701e853c244d391d}},
      {{0xb7e586f84eeb45d1, 0x9e887a058ac3b260}},
      {{0xa6249fd0989c68b8, 0x8b4a81280498e3ce}},
      {{0x24ab5655eb0a1964, 0x2cedd39ca74d6560}},
      {{0xec0bf688f0f0aefd, 0xf273c9de0708d94e}},
      {{0x7b9153ab01e745a8, 0xdc8dee68a45cc53c}},
      {{0x1adf81dffc4134da, 0xc76d1fc9b96d9dc7}},
      {{0xd63cc99cdff50381, 0xf6ffa10608e3aaa6}},
      {{0x60b10d079dc802ce, 0x63fb129596e16403}},
      {{0x6280c6b47a9e2bdb, 0xabc1bd758c375d62}},
      {{0xb7c1bcbc75be9aeb, 0x8005659b06172c19}},
      {{0x6ff5ee71fa7dccd0, 0xff63595680b63153}},
      {{0x8d1cb2f406bf71fe, 0xbf471b33ecb61dd8}},
      {{0x22882ff3a7dff19d, 0x829c2cc250628dad}},
      {{0x63418601d8a8b073, 0x9ade0ed7a88085b6}},
      {{0x854cae29d71334b3, 0xf7ed5d7ca66189f6}},
      {{0x661f85effafe24ff, 0x26153aa05c20f9c9}},
      {{0x6866058b372daf5f, 0xcff8f1bad9fb4571}},
      {{0xe8896b977d744964, 0xcf1ec311de7b02f4}},
      {{0xadcca40536aea9b5, 0xf48b5d5163dc461f}},
      {{0x628747e0eae12e89, 0x4d88912cb1dfe033}},
      {{0x86d88eed79594529, 0x456bb295bdba5f29}},
      {{0x979d2b4a9dd2a81f, 0x7ac100e8150deb50}},
      {{0xbb148c4009757011, 0xd8cd15dc94e44865}},
      {{0xe419b12f3a6a8d9b, 0x4b5682df0bfdda98}},
      {{0x9ed82f830231e446, 0x29fade765d1e36cc}},
      {{0xed5c9c16ccffdc9e, 0x6b0bd91255fadbd3}},
      {{0xb5ca13e16befd49d, 0xd00401f35e43c6d2}},
      {{0x384d325282ee7de8, 0x425bc000fd59c444}},
      {{0x7b03f96cc28cb754, 0x8b4e209da849f327}},
      {{0xcf1eeac570c99d58, 0x72f9dcba9d05b8ca}},
      {{0x76523c9a7b93983b, 0x3ab51da0b65f0d74}},
      {{0xcdfa49e577370f3, 0x388bf74710bd1d36}},
      {{0x895c963aad3d06a6, 0x3b0d6fe960ad3eea}},
      {{0x8a25106a3844a2b2, 0x66ceafcfd3de6b88}},
      {{0x5be0754dc0ff4c04, 0xe557635aba3a35d5}},
      {{0x4b799de08cbd87e4, 0x395e264a12a0589}},
      {{0xc4dc2412055353dd, 0x30894ba8392999a8}},
      {{0x9e894a803dc401be, 0xd572c4d02543dc21}},
      {{0xebdba67ecf29ad4f, 0xe9a51475d9e535bc}},
      {{0x2b34302dc952e16a, 0x70e602d9120f3507}},
      {{0x18e16269488e90e3, 0x436bf2273eb9643c}},
      {{0xdb2b2a14c5a40008, 0x275cb14c55fe13f5}},
      {{0xbab3863afb5e3c02, 0x6893d23d761578f1}},
      {{0xd5850f15c76628ae, 0x71dfaafeef21128c}},
      {{0x328ac127e1668415, 0x339f6cbd4cdee482}},
      {{0xc63c6a8b2c98fbbc, 0x18f68c623c32f767}},
      {{0x97d1333d2e3362c5, 0x7dae9cc12400817c}},
      {{0x63b5c70e11a75dff, 0x9ac19e23584e2963}},
      {{0x217f542a78a2f1fe, 0x13b7e2c37d246b6a}},
      {{0xa1cc336f9c5e6a81, 0xedd51091364e9736}},
      {{0x638bdfb15d42c927, 0x67c5a3ed2bbb2d55}},
      {{0x94d451ca7e0ddcec, 0xe149f087470201d8}},
      {{0x4ef1b6fedc237d05, 0xe324745bd4f3263}},
      {{0xb53dc88c3f9b45b5, 0xabdd8032ce352672}},
      {{0x70f742a54cea5268, 0x85aaafd47dc9c60a}},
      {{0x8e976b0af4c15, 0x412f2098342f810d}},
      {{0x7d3e66ed941b97a5, 0x2bb9f3b56228e2c0}},
      {{0x827d458ef7e6170a, 0x633aa7537c33a158}},
      {{0x6af61d545a203023, 0x8ccd66c24aea23b4}},
      {{0xe1557262f7f22f0d, 0x8578bd3aeec5e233}},
      {{0xc61ca893c9c82d6a, 0x32e403c4973872cc}},
      {{0x61805b1b6ababc7f, 0x8b0d4369b1ab50cf}},
      {{0x2e618facc999f69f, 0x21c40b959be51250}},
      {{0x5d1ceb7d27fffc63, 0xd62f3a4e9057e523}},
      {{0x97b64fa924f228aa, 0x79f4e23ed8e862eb}},
      {{0xbd54665b95010189, 0xae8024561632cd25}},
      {{0x77663e344e0630d6, 0x8b589e32ce4d2498}},
      {{0xabe9463b9d3398c3, 0x4268964b3abb36ba}},
      {{0xd26596845037ca7a, 0xef097499faadd275}},
      {{0x18103806992e26d, 0x3528006533c0cd47}},
      {{0x928f3944195c56a8, 0xc693702e06594cc6}},
      {{0x49d12784e8c3f93a, 0x208c652aad5645ba}},
      {{0x390476afa822718c, 0x399c90761d9c2ef3}},
      {{0xbbe86b911f563f88, 0xc71a69207bddcba7}},
      {{0x4f02282a23c573f6, 0x1d77cd1d2bb555f6}},
      {{0xbe96abd097f2d5, 0xefc4a0e1f17c99a0}},
      {{0xacb0c088b8fcf46d, 0x6377f8dfa56a15fe}},
      {{0xc1ae515cdaedc107, 0xc921afe139d80994}},
      {{0xdb1974606f8bc1ab, 0x3a25934685f0aa7}},
      {{0x14096baef10df1f4, 0x1961aca24e376fa0}},
      {{0x2ce35ea38144dc9c, 0x6a0f444a95fa2ead}},
      {{0x1f726d1ae294cd7b, 0x94c0be58689a4dd9}},
      {{0xc75143372ed4c3c4, 0xfab0d7879a890397}},
      {{0x194a6c60f35739b7, 0x2325eb592b8b241b}},
      {{0x215f4b71663a1912, 0xd6677f82db63d751}},
      {{0x5e0ff508a9414c39, 0xdd327e73a96c78bf}},
      {{0x768eb5bedb7bc9a5, 0xfd56b9560409e61d}},
      {{0xb4b0633b869d4966, 0x47d7e491a82f9970}},
      {{0xd624582925840faf, 0xf29510ba7dee2625}},
      {{0x156cd49a055fc65f, 0xe16dce7810a1be32}},
      {{0x86fb939f04b8fd45, 0xd7b22e421a3f12a3}},
      {{0x292ceb5f2418d59b, 0xa615990efb228c3e}},
      {{0xdc020a866f6f27ad, 0x3583e88184c4da3a}},
      {{0x3f17c639174a1228, 0x6762a015760877d8}},
      {{0x285aa00cdfa877df, 0xbc7426eacd05c76d}},
      {{0xc534313b28319a91, 0x5e9f6b9c306b7fd8}},
      {{0xf1dcb31783ecb3e9, 0xa2275086aebc1b6}},
      {{0xaa7e1c7827d9c9ea, 0x788fc12f89a93f4c}},
      {{0xa5ceee6a278bf62d, 0xb3b86bec8b139f06}},
      {{0xf62cbd6bceaa663a, 0xfbdaa602f084fdbb}},
      {{0x5fe946113878367e, 0x2372ce5984444469}},
      {{0xac7281a3b59e4a2a, 0x355f4654e7bd68bb}},
      {{0x63f030bef9299952, 0xdec7d7156f907dd7}},
      {{0x900e0a00fe60c101, 0xd3cc569673615462}},
      {{0x92cbfbd8b2a10d64, 0x1ecc6e6e7b0bf802}},
      {{0x2ad43ae9d49d7003, 0x1788cfa77037c3cd}},
      {{0xcf49302fff561d46, 0xb426b1e2fb17687d}},
      {{0xb24012a16d55aa0a, 0xdc4f7cea6b7f613a}},
      {{0x9ad204b355756269, 0xea375f99ee407cd4}},
      {{0x6f970ace0736e3, 0x936d8866f8489a3}},
      {{0xe9770e52967d1d72, 0xc48b6a6371a2e0d4}},
      {{0x1895d4cf7691ebfd, 0x6e20d5997cb559fd}},
      {{0x2af37448a645f869, 0x32f64a0c5c121efe}},
      {{0x4fd3035c1dac4f18, 0x3d67ea8c182f40e}},
  };
#endif
  alignas(32) constexpr static std::array<uint64_t, 2> m3_transposed[128] = {
      {{0xb454313f7cd2482e, 0x6ca177da9e0abb6d}},
      {{0x6378f0e87ae8238b, 0x1b9e92e699277d81}},
      {{0x7e1f45c9e62326a8, 0x214515f36f491a6f}},
      {{0x6abc1bae66eeb97a, 0xe60fdec8d4fcde92}},
      {{0x6c0cbdb97f4ae9fe, 0xb016328ee3251828}},
      {{0x6a6af205ba87ab2d, 0x7c4fcc7ab53c6d5b}},
      {{0x70762e40ebeb5fdc, 0x7d54d1a1a70f2c12}},
      {{0xfa4ee3a337feec94, 0x2800f65373d3d04a}},
      {{0x683e0e25c6557243, 0xb170d777b9e086cd}},
      {{0x9806c40240f2040b, 0xae0f7cc1039c12d0}},
      {{0x25134fe6710e5e4d, 0x994717c8c4903eee}},
      {{0xab111aabc1c3a131, 0xf358a17ec0a66e27}},
      {{0x69443f901e892715, 0x59957b0667f339d6}},
      {{0xdb30a65b7e4a888f, 0x6e87550227e97f04}},
      {{0xf82523d48704d267, 0xe4ab93b9ff7c303f}},
      {{0x4c729de94d821ec2, 0x6231e391fe2e3843}},
      {{0x301779d6571c5d85, 0x7ed1a4ba3b26b06e}},
      {{0xf76533a936c56672, 0x90b0c9612ef6afd}},
      {{0xa7cbc791e7d48481, 0xdf8844e3ef9520a2}},
      {{0x89534fa56fe1d6ca, 0x909fdfb43c103c7a}},
      {{0x992770dcb7d2afb8, 0x378ca3b7869e7a48}},
      {{0x769363f3eb965cb1, 0x947675140c466bb4}},
      {{0x872dabbea53e6749, 0x5724cc9b4db06691}},
      {{0x68cb1f8b2ef6cc0d, 0xa0cbd1619f287eb8}},
      {{0x27bc711cd4b537f9, 0x8719dcda719ab689}},
      {{0x1310376377515592, 0x7963dc3799812b8a}},
      {{0x9a9e6089d6b8769f, 0xffab9fe51083e2df}},
      {{0xd97ad1bea979daf5, 0x8b3634191cfb1d1f}},
      {{0xe108b82df9fa8aa2, 0xb5fc18122e9683ef}},
      {{0x5d08d927e5cb1bd6, 0x637da64fb5686aaa}},
      {{0x47f13d86b9db4bf2, 0x2fb21416ba2d1f97}},
      {{0x87b3468a3d3bb626, 0x59fa503aee6296e4}},
      {{0x9e610965fd2d1307, 0x278e6b6542c2ec51}},
      {{0xed14f2e8e42c27d8, 0x3d1b67b1e3428ea6}},
      {{0xb6b12ca5a2f93362, 0xa1105711287531fc}},
      {{0xf971f42c709e5021, 0xe9d3bbf8af42f8ce}},
      {{0x1394728087d9c24c, 0x9454ebb58883ad25}},
      {{0xd572c52637c45e47, 0x79ba87773437275}},
      {{0x80538f1e2709d381, 0xf0c382061810a366}},
      {{0x80a3946e6dee01e, 0x26d8059066ec54df}},
      {{0xb603056ae43c886f, 0x884a633da8b879a3}},
      {{0xbbd84b4e9f47ea35, 0x9ae54f2562effa55}},
      {{0x631770d77de3c93a, 0x7c07889ad267d1c5}},
      {{0xa8a1cdc95b09eca, 0x10e38646e1917d29}},
      {{0xd023d7a0028782d9, 0x6bd2e1d85a550b07}},
      {{0x98f53e69978207ff, 0x41d3723ab1f1a664}},
      {{0x6c490c02815710af, 0x60450aeffcc2eafb}},
      {{0x25126cb53bdad676, 0x284b5b980604342d}},
      {{0x73daa62aa9af66e4, 0xf944090d703e129d}},
      {{0x45903d02600b3455, 0xdc699d1ecb114151}},
      {{0xea24ea9b7318c0bd, 0x38a3eadc0a55e7da}},
      {{0xcc9e6bedb61b2e8c, 0x967d39e3a9224e9}},
      {{0x793678fc233c274b, 0xf498f9259620e7de}},
      {{0x69e380004131eda5, 0x581ea3e0ce8751dc}},
      {{0xd05773c5598852a8, 0xdfddd187c0a79396}},
      {{0xb75d214f85ed40c8, 0xe4d541304eba4917}},
      {{0xf2b34d991b846c46, 0x91156a8799ebea49}},
      {{0x3dbb9c5e2ddcf9f0, 0xc7d6895991975585}},
      {{0x1a0c39ed3393f696, 0x810f2df9e501f44e}},
      {{0x1fbeed1c30e381d, 0xf58c9e0ad5e2b144}},
      {{0x17c91758009c5cea, 0x26664cfab0d5e05a}},
      {{0xe53017b3ede7f97f, 0x529bda3444c39b59}},
      {{0x2a971ca2e97622f5, 0x9116645919252f55}},
      {{0x9b9cc9fd9292c89b, 0x176be5611c96c68a}},
      {{0x29ab049765a82163, 0x299e115fd0ccea25}},
      {{0xec206d83197a855a, 0xca7b478b15fa6a1c}},
      {{0x9af136519c1ea7c1, 0xf591d2595d9c8d21}},
      {{0x5256c8652686aa38, 0xe38ebe1ac4234cb2}},
      {{0x91d131abdb842903, 0x771a6ebf8d67138b}},
      {{0xf9dc7416dc55444a, 0x6b2e57e877e6e30c}},
      {{0x79815bd8f34bca65, 0x75b4b824855c5ccf}},
      {{0x797c9e0be1899bf, 0x7c9a6909fff34d42}},
      {{0xf8b7b48c7f4fba9b, 0x2a93f825afa8a1a3}},
      {{0xca80c5ed8010da24, 0x4081bdd570c6575c}},
      {{0x8c7b73454eed1cc0, 0xc437bad6e57ba019}},
      {{0x610cf8bc36da2eda, 0x6d5ba6a8fad88001}},
      {{0x8bbd6ce4234a6067, 0xe473adac07061c04}},
      {{0x6d71cc4a21b1f3b7, 0x975aa8da604367cd}},
      {{0x4d4887bf60679335, 0xb7fe7c1ca1bcee50}},
      {{0x9c0c0faa3c1ed352, 0x98c356b4028ca2f0}},
      {{0x37c7f2ad0f96fdc, 0x23e9f1b731973abd}},
      {{0xacab91c6c7d05a5e, 0xd3c16366f422a9a7}},
      {{0xe5b0f87b03cd3440, 0x2b8e156833e5322c}},
      {{0xa4e7f6efc00fbde9, 0x248e97bded74d75}},
      {{0xdc1b2e7c3c49a0c, 0x63990100fbf2a489}},
      {{0x4ad760b4f7781104, 0x32a8e3ec6706dde9}},
      {{0xa49897b3d43d791c, 0x624644c5eb97314}},
      {{0x4d0e0b74b30d130, 0xb81ac4c3c9ce5b11}},
      {{0x429e8aef400b14a8, 0x9b79924e4fe81c17}},
      {{0x8361912190a34cf6, 0xf794b07219f974b}},
      {{0xdfc81bdcb2e7a077, 0x6c1c1c50647186be}},
      {{0x6e550f64ea585d38, 0x6f51d36fb9e7539d}},
      {{0xe9f5bbdee4280472, 0x71e22bc54acefcb4}},
      {{0xdb4f56071a0d3815, 0x3ffa6a6a9fae0af5}},
      {{0x6790c3c1e6000469, 0xfffa5a44b28543da}},
      {{0x2139e16db6d45d6, 0x850f962d46257e0c}},
      {{0xf570e5258ae84ac5, 0x34948c2b0f0e18c7}},
      {{0x6a41a9e04f920a2f, 0x1be2935d6473e38a}},
      {{0x7d2a47619736775, 0x48f9aa111558f457}},
      {{0x7a5cc3a508fb6db, 0xe645f2c2c5366a21}},
      {{0x87390df5dbe324a7, 0x243c28fa9545d2f8}},
      {{0x2f56594a7244a5d8, 0x93c190c83af94a49}},
      {{0x5abbe1791d4e1640, 0x134d119ace4aad95}},
      {{0xd62cdd3c6cab12b3, 0xafa134652e041573}},
      {{0x85f193d3dbb78d, 0x2591e21719a01ed5}},
      {{0x6367e064aa2d5cbc, 0xd4ff318f88037dd5}},
      {{0x3c18f8511ccc3e59, 0xa6fe51ade9278394}},
      {{0x3e04d8c13f4e58a2, 0xdec5279ebd813210}},
      {{0xb1d038d773694c6f, 0xaf30425d94572242}},
      {{0x46c3e40464d44477, 0x93437d3eaeb4e3f3}},
      {{0x454f6ac1d187576f, 0xfefde4af55b44946}},
      {{0x7bcaaae6c057a078, 0x29968eb3af4342db}},
      {{0xe7577a9d33ff042f, 0x1618a6e66d14296b}},
      {{0x5f69a6e58b32bf53, 0xdf1eed3c559020b4}},
      {{0xdeb3d530be9d2d59, 0xcf78b2f647607d29}},
      {{0x16c4eed7dc3dfee1, 0x12eba08040ef2bfa}},
      {{0xcf8b1a60ec323bcd, 0xcc0f337905d142cc}},
      {{0x58781844513b136c, 0x6d05598f3d0a66f4}},
      {{0xaae98e7c5b7b9662, 0xc27e18b4a703570b}},
      {{0xff36b85b5c7551de, 0xd0f3a5619270d559}},
      {{0xd6db44e6d3688fae, 0x88af0dba3fcd5afb}},
      {{0x64c2dea8ff7ad044, 0xe4f76b675697accd}},
      {{0x90898007f31d547c, 0x33d83f3c839ca315}},
      {{0xb91074facb45d6ba, 0x2e52f0196b45c94c}},
      {{0x7e2c79191b166d79, 0x43fbb55da1486400}},
      {{0x97b5f8c933732bd5, 0x650f9ed3466cd4cb}},
      {{0x93798bbfd13e2416, 0x3632a9fd4e9660a3}},
      {{0xa0190511dfdec1c4, 0x173313dd8a95ab1a}},
  };
#ifdef INCLUDE_STANDARD_MATRICES
  constexpr static std::array<uint64_t, 2> const *matrix[3] = {
      m1,
      m2,
      m3,
  };
#endif
  constexpr static std::array<uint64_t, 2> const *matrix_transposed[3] = {
      m1_transposed,
      m2_transposed,
      m3_transposed,
  };

private:
  ~Params() = delete;
};

bool rain(const std::vector<uint8_t> &key_in,
          const std::vector<uint8_t> &plaintext_in,
          std::vector<uint8_t> &ciphertext_out);

std::pair<std::vector<field::GF2_128>, std::vector<field::GF2_128>>
rain_with_sbox_output(const std::vector<uint8_t> &key_in,
                      const std::vector<uint8_t> &plaintext_in,
                      std::vector<uint8_t> &ciphertext_out);

void rain_mpc(const std::vector<gsl::span<uint8_t>> &key_in,
              const std::vector<gsl::span<field::GF2_128>> &t_shares,
              const std::vector<uint8_t> &plaintext_in,
              std::vector<gsl::span<uint8_t>> &ciphertext_shares_out,
              std::vector<gsl::span<field::GF2_128>> &s_shares_out);

} // namespace RAIN_128_4
