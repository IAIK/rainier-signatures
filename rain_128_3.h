#pragma once

#include "gsl-lite.hpp"
#include "types.h"
#include <array>
#include <cstdint>
#include <vector>

namespace RAIN_128_3 {
class Params final {
public:
  constexpr static size_t NUM_SBOXES = 3;
  constexpr static size_t BLOCK_SIZE = 16;
  constexpr static size_t KEY_SIZE = 16;

  //--- ROUND CONSTANTS ---
  // Round 0:
  // 0xb4a17132a6a74a186228e5ddcd08cd6e
  // Round 1:
  // 0xe4726766273a9de9d24cdd5d4c5f8fca
  // Round 2:
  // 0x506a1cd4f5a6e2351c08dd17166e316d
  constexpr static field::GF2_128 roundconst[3] = {
      {std::array<uint64_t, 2>{0x6228e5ddcd08cd6e, 0xb4a17132a6a74a18}},
      {std::array<uint64_t, 2>{0xd24cdd5d4c5f8fca, 0xe4726766273a9de9}},
      {std::array<uint64_t, 2>{0x1c08dd17166e316d, 0x506a1cd4f5a6e235}},
  };

#ifdef INCLUDE_STANDARD_MATRICES
  alignas(32) constexpr static std::array<uint64_t, 2> m1[128] = {
      {{0x17ac9f98c8ce128d, 0x90a8ece6d2c5f35f}},
      {{0x88ebc82715f1c6ba, 0x63752b5d28cb21ff}},
      {{0x9ab0e58883f54f2c, 0x5eb03a6cac12892d}},
      {{0x96fdc8e7a1d2354e, 0x5b2904611e00358f}},
      {{0x31cc6a8201511e4f, 0x2ba15076e439038f}},
      {{0x2b806e7b4808b44f, 0xa8caefcb7ca40112}},
      {{0x2920a0868145f039, 0x5007502410d1db9c}},
      {{0xd50c91941a3dea5c, 0x9634561cbe67716a}},
      {{0x5502d1a6cbcfb4f8, 0x883ffb32ff8413e1}},
      {{0x7b0ac8ff1abe6c6f, 0x2223ef19314728b8}},
      {{0x951cbd85fdf20821, 0x9e24a64b07e58e03}},
      {{0x1472caced3157923, 0xaea9b2859c7a58bc}},
      {{0xe7d622bd4715a9b1, 0xc4812a2e66f56fd4}},
      {{0x8362ca2cbcf6d898, 0x21771040193f8717}},
      {{0x8063c141e97998f5, 0xbba326eda3100097}},
      {{0x9295f585b676d59, 0xabdde1d4ae2a3f63}},
      {{0xb8083ecda8a4a7d8, 0xa4fb09c7d1fc9d4a}},
      {{0xcce70915a5937d08, 0x22a3e307d3baa6b9}},
      {{0xa98686f6136f08eb, 0x8215b4adfcd0881b}},
      {{0x252fb3910d8e342e, 0xbc9c73c503744226}},
      {{0xf338be296147cfdc, 0x2f24c31e4ddcc846}},
      {{0x3c9fa9dcc4ba1add, 0xc27669314cac743d}},
      {{0xbebb96c3df3650f4, 0xd549899b7a1b0246}},
      {{0x4755a727ce943e04, 0x9b265ae32ae7c0d2}},
      {{0x15f7a16ad6e98e16, 0xf5a77d5a9fd86b16}},
      {{0x94644357ab7924ba, 0x299675378b7a9f6a}},
      {{0xe3bf0e4550f0f74c, 0xb304d13ba69b2b84}},
      {{0xd0eeefa17abd4811, 0x3c9c02cce4afee78}},
      {{0xc07ec4f5ac55ca70, 0x2ade58f121175290}},
      {{0xbe4afde8c6c79bf2, 0x69943d5e9268734c}},
      {{0xad57791e0e4bbc35, 0xb5d9899c0717115f}},
      {{0x7aaecde97d2e99f5, 0x7803e4cae9c9d586}},
      {{0x3bdae6ecca50d896, 0xabf07401f9a37d4}},
      {{0xd678da6dad9ca2c6, 0x4fe46be9e4b7b734}},
      {{0xa5b05d129564be01, 0xe531af7f11c6fa0c}},
      {{0xc76ea6c762df8373, 0xf17689f8d623ac63}},
      {{0x23be7d874c957472, 0xfb325ad872654e7b}},
      {{0xb040f411ad7f8c93, 0x1910929b681859ca}},
      {{0xf757649527eedf38, 0x53b997ff27ce335f}},
      {{0x151ac35c4d487faf, 0xc12a280b68c37152}},
      {{0xe19d19e1a047376a, 0xf600bb6f7c5dd74}},
      {{0x1207b78cbbd93911, 0x78a0fc32966e0385}},
      {{0x87f69340d91432fe, 0xb97947faca9e0111}},
      {{0x9a9b2e6ae6c7cd04, 0x591ea4bb5b21adda}},
      {{0x3794fdf8f3664e53, 0x5054991f0f3e30a5}},
      {{0xb47805e690dbd7f6, 0x513112904cbbc211}},
      {{0xaa06292cc449ef16, 0x42a51cbe1cc157fa}},
      {{0x44c46c615d375558, 0x89ba01f4c3d49b12}},
      {{0xe1d5f5ac54b9f794, 0x7a23a7074bc92431}},
      {{0xd6784c1b4cb9cf87, 0x3106d1ba95b56f4}},
      {{0xf3a4635ca2f4ab4f, 0xd9d551cfe895ad67}},
      {{0xf7a1ad14a37402ee, 0x19bccb624e7c32ff}},
      {{0x791b58004bad97f1, 0xc00f1902a1f2ec37}},
      {{0x4b4a76eaec4d3db9, 0xbeb56adb11b51844}},
      {{0x97d0231da0b0b0ba, 0xae03b5018224f841}},
      {{0x805d161cd514c4a4, 0x294f1e558d09fde0}},
      {{0xdba675be2a901544, 0x2a8ed7967b7b685d}},
      {{0xd8e97127af98d957, 0x8df906e5f61619f6}},
      {{0x401641b434f62c77, 0xb44011c9ab812675}},
      {{0xd0efc77be26ea5eb, 0x4ceba4c14fb924e8}},
      {{0x5678c1b5e8d3e55e, 0x99babbaa05c284ac}},
      {{0x6c6aa09a94b87e07, 0xf3e9c7bf660de662}},
      {{0x40f8e958bce39d62, 0x6a5ee4dd5be8c8a8}},
      {{0xe68a1d0b2982f6bf, 0xcb5705b2ca3da39e}},
      {{0xc2c52e3d96b39512, 0xf0f52571c2229df8}},
      {{0x9fe7de4c36ff49c, 0x68da742712d51f38}},
      {{0xa9c9dc31395cf250, 0xe5333c5b1cb0361c}},
      {{0xc678148b2a0781ee, 0x3141c62d32ac7102}},
      {{0xa76bd5e1bf97abc0, 0x4eb2e82a361096c2}},
      {{0x1fa345a6106be1c3, 0x8c48e1146fcd5f4b}},
      {{0xd5f279e907351518, 0x97c5c30f25e18272}},
      {{0x460d340fd29b3354, 0x948108ccec138c79}},
      {{0x87f19c59114bc886, 0xdad7a695e0c876bb}},
      {{0xdc358c2cc7b36483, 0xbb6497c6d3ff1561}},
      {{0x4842491f431b3f00, 0xc2fa8cd2517e7142}},
      {{0x8d6b25a7ca346f7f, 0x9edea5af485971f8}},
      {{0xfb496477d31db721, 0x88bac8e374a1ed82}},
      {{0x12ea001c22833f3a, 0xc95836025f325269}},
      {{0x3e1222764fc986b3, 0x7e1ca7ddd9f5d616}},
      {{0x66ff0db0559f5aba, 0x6eed0a70621d1ff2}},
      {{0x5262026cdf4128ba, 0xadbab5f01a77cd24}},
      {{0x8117f8aed99905b3, 0x4b2c7061023a901a}},
      {{0x7ee68ecf8ba10865, 0x2852e829dde347a9}},
      {{0x17414b8a5432ffdb, 0x6525d3984d29af61}},
      {{0x368caeb137f64e2c, 0xf1d8b9fe78d538b}},
      {{0xb84d1960637962a0, 0xeb760ffa1f052063}},
      {{0x40068e0949da49fc, 0x86ea3249de54395b}},
      {{0xc88473c4720d3753, 0xe3b662d24b4a1914}},
      {{0xe7f0b44d35980297, 0xa3773ac63b4ffd99}},
      {{0xd23b04ad8a0e0f1b, 0xe55cc31909f90893}},
      {{0xf4eb9396dbcfd490, 0x42021ba7ffccd7fd}},
      {{0x8bc6259008ed2737, 0xe81d49902f52db33}},
      {{0x9cef40c7f2c12208, 0x65719d18de807510}},
      {{0x73319b5b26897dcc, 0x8021bbaaa28f6351}},
      {{0xa731adaa9a5ef72d, 0xb3fa5e8d221b5c53}},
      {{0xd3bb9f92bebfdcd, 0x926e67808242c752}},
      {{0x436a3644c31f7f15, 0xd89d8678f8a7d18}},
      {{0x9d425f9f4e0259d, 0x3b3c900c0fc5c604}},
      {{0x3fdde57bf6b9193a, 0x975b589f14f7095c}},
      {{0x15703c6427ddec62, 0xe842873d6a43b579}},
      {{0x14486ab7e4a2f723, 0x87b27ed19e0e88eb}},
      {{0x7d5518573923dd7a, 0xe702b92ef9f510d1}},
      {{0xc0c932581f6d495f, 0x32fdf46880280b5b}},
      {{0xcb8e3c58a98bc307, 0x62e1edcb9c4c653a}},
      {{0xee576ae3d752ac8, 0x58ab32d6fdb0c654}},
      {{0x4ba1cf3500bef78a, 0xf210700d3d50b6a6}},
      {{0xd3ff30faf55c6c30, 0x1519f46412d678b2}},
      {{0xbd142fd162903960, 0x1ee19a1d41d6beaf}},
      {{0xa62342f2a6e4a28d, 0xff2280fcdb8f51e3}},
      {{0xb4201fed85d80f3b, 0x4f71afd6e086a601}},
      {{0x12458667e2964e13, 0xf1b57d173060ca5f}},
      {{0x9def2b7fb1ffc03b, 0x841791aad69b4332}},
      {{0xbec7019891d8f2e7, 0xa404dd97ad4e2416}},
      {{0x250a12889ab81f1b, 0xad3b4edcb3bc9c9d}},
      {{0xb2172de68dd3b03f, 0xc7c875007cce7bb1}},
      {{0xafa21c5e53a4f05f, 0x60ff6eb34ba31a55}},
      {{0xfed07bb816011f46, 0xa78b28c29a9f3142}},
      {{0x57289a54a4b55023, 0x49594351b0652280}},
      {{0x7b2c072a73bf1475, 0x80b8ef6be79493ca}},
      {{0x9d2f2a034c30be45, 0x1044c59ae04d1741}},
      {{0x29b19b4d370f6849, 0x61e60d1b28fcd1a3}},
      {{0x871b25ffdabcefbd, 0xd4f4617fd9f7ac39}},
      {{0x23f85d6b903498a2, 0xe34cf4e39edc2b4e}},
      {{0x6213d79ac853e08f, 0x4bbf90b0dbbb9031}},
      {{0x8400e45335f6aad4, 0x9fd3e070c1524665}},
      {{0xdfd377fcf66ec92d, 0xb8a688e086d9f362}},
      {{0x63b48ec07ba8f23, 0x94600442dd584c5d}},
      {{0x2064949e75839ed0, 0xcbf0171494c5478}},
  };
#endif
  alignas(32) constexpr static std::array<uint64_t, 2> m1_transposed[128] = {
      {{0xae3612acc824de71, 0x6beff0d3cb8e5a20}},
      {{0xfe4e75bb230c0a3a, 0x4c3fe2fc0b8beb29}},
      {{0xb78f6c83c5f842bd, 0x3add10c3e954098a}},
      {{0x986c85c0063fa3ff, 0x2b0eb366f259a84a}},
      {{0x9671f679fb71f1c2, 0x924ee4670fcbe8c7}},
      {{0xccf825d8f24c5f46, 0x6665ac3c4877f808}},
      {{0x5f1cb51ab475c3b8, 0x91d90968a0cc08bc}},
      {{0x88fb24a3a2757103, 0x9e011302a56bc33a}},
      {{0x5b37ebc8a413980c, 0x62122af7eaca3cf9}},
      {{0xa01f75ce35b10097, 0xd29373915bb8fc94}},
      {{0xfdb3f9f4479b833e, 0xc2d2663bee9a7e43}},
      {{0x66265ae5f9b6fe94, 0xf7926d6da25dad10}},
      {{0xe371a7d5e4ea6979, 0x84ff0a35e488b4c7}},
      {{0xbc654796468b9be8, 0x1b8d1f1bf8a93eb6}},
      {{0xb283f8d11c52aac6, 0x2b29c6f9e4788b26}},
      {{0xdad7686ff51171e2, 0xfe8d92b8c408513f}},
      {{0x5033eb387b16d9d6, 0x897481edbca7f7fb}},
      {{0xdc00b968e07ea709, 0xf944c2b1c658a7bb}},
      {{0xcbc9d7eb8ddbbc5, 0x3768d7494e90985e}},
      {{0x2a3362eacb2c43a1, 0x6343a6cdefe2d5a6}},
      {{0x37cfa63b1ee27e9e, 0x5ee7ef0d417a9ed5}},
      {{0x6c5f90648f65e686, 0x76ea9376883c0a63}},
      {{0x5c2c7bed7714e55f, 0x3805b54adc714126}},
      {{0xf7572a5a2dab270f, 0xd26ffa9ebd56e291}},
      {{0x829896e6825edd5e, 0xd14da5e98577d756}},
      {{0xb1c1a496bc49b84, 0x635a584df6b57edb}},
      {{0x66a3c8f6f1ea3402, 0xf1b4355e2119c251}},
      {{0xd33286b3dac9e7a1, 0xa8601e0ce47481c}},
      {{0x6481b6048d44ae82, 0xb75b8566559b91b5}},
      {{0xdf6c1b6a9a136408, 0xb160ddbeb1b0201c}},
      {{0x18b3dc99adf0dd21, 0xaac84c1714ebde82}},
      {{0x7aec7f2733e36d4d, 0x2e27f49756071a93}},
      {{0x9a42817a9edb562a, 0x1780ea36b3541ddd}},
      {{0xab22281c43c40b7a, 0x9eccd534740e5ca8}},
      {{0x17cd62db56a73fca, 0xe32ce33917877ea3}},
      {{0xe9e75a83e131ba25, 0xef5ba5c6e34f27c9}},
      {{0x7dce10e4522e92a1, 0xba399ef6ac10f505}},
      {{0x1f21f903b994332a, 0x6654f71ec233da77}},
      {{0x4824bd8bb765ca28, 0x772cfcefb1a55152}},
      {{0x35213359b86d1fdd, 0xea173d12de9e887a}},
      {{0xdf4d7794ebaac585, 0x2f55aa06eca88c72}},
      {{0x8e40e8b0eddb831, 0x29f2fb5124dd4001}},
      {{0x89abba7dbcd58425, 0xbe4c6b8f4b549bbf}},
      {{0xc01ad916ec33ae3b, 0x45bcaab8e07e8747}},
      {{0x83b1173660598581, 0xad3a25e9a5a201de}},
      {{0x636dda7969b91474, 0x32948ddfc99258c3}},
      {{0x5f3790f7fa00eb3e, 0x7c101314108a1476}},
      {{0x780916abb9fc6fcf, 0x99204204e5560314}},
      {{0xa990b4045eac00a, 0x6b85d764f62a9bb5}},
      {{0xad304ed9fd6e7b02, 0x6a8f94819e47ec72}},
      {{0xd85d758dfae1499, 0x80c5cda618f68283}},
      {{0xfab2299bbc79869b, 0x46e284d59630b89e}},
      {{0x54d33dd755f01c0c, 0x6f140c2ee302c34a}},
      {{0x7b0e241e9f5ae84f, 0xc5e8b709f705ab7a}},
      {{0x7ae3a46b7b82781a, 0xa411c57f1d2dbd5f}},
      {{0xcb4d9d158d66103f, 0x251987c61d94a167}},
      {{0x17d15dd459cb7f1, 0x27ea8eafe90a1976}},
      {{0x916e5e5ba4d0322d, 0x6e7d57856b1df1b9}},
      {{0xb04ab4ce63ea1d89, 0x72bbb93cd51ccbf8}},
      {{0x23304801e0678266, 0x21d98ba698a45e26}},
      {{0x1b5e3ae3ab710f9d, 0x20f5ec3c363d7260}},
      {{0xa01d7175e47d1270, 0x8d5f38246534d014}},
      {{0xff3f814a9c921380, 0x287006e127c596c9}},
      {{0x8bcf6d6e7e57748e, 0x329dbcc05fa21b5d}},
      {{0x55d36584026e51f, 0x5b8e78786f7c23a0}},
      {{0xa21cc8f8c3dde4bb, 0x2551ded0ca72d578}},
      {{0x973e1347e578785f, 0x540b4b0604814004}},
      {{0xd90848746a270adf, 0xc64248dd055629a7}},
      {{0x871bedd359a67a63, 0xca0fc5edffc2c9c7}},
      {{0x7e9f511a0a2a8b86, 0xbb049e980c2dabc3}},
      {{0x2fee49f96ad19183, 0xf4d8517ce468aef1}},
      {{0xda8a5a2194825b5a, 0x1661e3007149911}},
      {{0x8284cfe3e701b1ff, 0x25d490cdbddd9e2b}},
      {{0xa40ae2573f4ab551, 0x34eceb42ac1ce176}},
      {{0x3c97491b8a23b408, 0xd2832b8bd50dd3b7}},
      {{0x43f4893c0f159e44, 0x460e4c554bc990a3}},
      {{0x2ead1e7f22189c9, 0xa9de1e295dd2ef3f}},
      {{0xaddd18cf2d22928b, 0x26352e8931681d0c}},
      {{0x61d261b4b9b818c1, 0xf104d583fd157d28}},
      {{0xf0d4a90e8a972445, 0x2b426b1a8d0b50d1}},
      {{0xada7699adcc036d3, 0x2ab8902e633ddae2}},
      {{0x131236cf5ec2aa86, 0x1a1dbc1de9872681}},
      {{0xa26c975658b937a1, 0x87f73cb62571c62a}},
      {{0xe98b3661af73a812, 0xed9790d1679a8f28}},
      {{0x8b3eb423575f7854, 0x7f528f244a43ee96}},
      {{0xc9783a1a2aabbcb0, 0xb2a4164020f764d}},
      {{0x511bc3d4a39d1ec3, 0xf7a54eae8fc54f62}},
      {{0x5c35e5c78db71563, 0x2f5ebd273614536e}},
      {{0x5db39945d31b6700, 0xda4b1b230fbc6660}},
      {{0xef499f5967cad589, 0x2c5a941bfdf3a23b}},
      {{0x3a88734b4d349dbc, 0x644583971c7c30f4}},
      {{0xcd8f7ca183f4a9ae, 0xcf1d13bb1fed68a4}},
      {{0x43204b1d21472be9, 0x4e36d7b41565761e}},
      {{0x271601f29cc4d3b6, 0x1e763286d1091f8}},
      {{0xeb0dadba88771131, 0xdaccb92814dcffa1}},
      {{0x86d6870aaf07c995, 0x7ef3b1f1b4544381}},
      {{0x6ee718e616ef4e2a, 0x87694a9d4656594f}},
      {{0xb13f5fe4a7d31531, 0x47d9e1a525b03e56}},
      {{0x6385d1446a1fd8d7, 0x2037f2f45104bea}},
      {{0x74265cfeed5456a6, 0x3c29aee727c48dc}},
      {{0xe1a2ff7c77708392, 0x9bab791c1ab9c525}},
      {{0xb208cf4e16a4515d, 0xbe4894692427981b}},
      {{0x4eac845fb989e43f, 0xf67235d101e3d685}},
      {{0xff24ed7ad8cdc821, 0x2c9bb194edb95f80}},
      {{0xb55f954f677b8322, 0x83e5e0a8be394a61}},
      {{0x33a92577089a5fa6, 0x6a2918e7f8e348}},
      {{0xebc34e45a30446a9, 0x45cf64d8d0216f0f}},
      {{0x10ba539e71e11327, 0x215b68b57d349494}},
      {{0x15d47270378c29d4, 0xc05cf77754b2206}},
      {{0x58630a86a32edf27, 0x165c67f0a1c76937}},
      {{0x612e061297ba83f1, 0x16ef46d5ca8e107a}},
      {{0x79491a6cc4568f21, 0x3cc1bceb321d5f78}},
      {{0xaaf56445c147fb5a, 0x983aedc5391881cd}},
      {{0xd9d1889993a36360, 0xb91a913cc5e51d16}},
      {{0xc1bc580b3fbca5c2, 0xaf89c0428bbacb41}},
      {{0x7b988cc158498929, 0x8c7e0547ca53fc22}},
      {{0xd22ebc7d7a2da186, 0x9a6ae6565bb57d17}},
      {{0x3a29e7df01b36f9f, 0xeb4a79d2f1eb9615}},
      {{0xee84150a5061a022, 0x57ac28ccd364af6b}},
      {{0x3b2cc2437b0bd835, 0xbb5c49d140c19dd3}},
      {{0xb28eadfe67d0e01a, 0x1d36743753bb224c}},
      {{0xe163415314b6ce9e, 0x1c143af6c5f2cf50}},
      {{0xe60010649591c84, 0xd217bc351259c8f4}},
      {{0xdbed8f33ba98cd3c, 0xb822390b0837fb32}},
      {{0x342d3e78cdc844cd, 0x72805f46c0004bc9}},
      {{0x65e1061cff1bea32, 0x251b52ea5badc20f}},
      {{0xe8157adea160104e, 0xf2c73a81eaae517}},
      {{0xb674849c45eddda1, 0x7657d23cebe13fe5}},
  };
#ifdef INCLUDE_STANDARD_MATRICES
  alignas(32) constexpr static std::array<uint64_t, 2> m2[128] = {
      {{0x59dc5a98e0cb94cc, 0x66008070392be2df}},
      {{0x12dc377e869c1165, 0x7f7a264add120d88}},
      {{0xa660c66e60602ef7, 0xe3c841af7383ff30}},
      {{0x72dcda24e2ee799f, 0xee6ef91d9a167595}},
      {{0x78b952885c30b0f1, 0xc3dbfccf3ebabcaa}},
      {{0x57affa051601269e, 0xe4c52e4cb233349c}},
      {{0x74424adb5b1dca23, 0xc7405e5f5cf505da}},
      {{0x40f350ee6d2ee4c7, 0x2dff47459a48d4ef}},
      {{0x6b1367b61949785d, 0xd4943b110d899579}},
      {{0x4b1787b8e8d73bef, 0xfc30da4616d4ef06}},
      {{0xe3e02184ebcbeae4, 0x8c132cd6ee443b7b}},
      {{0x601ef302ed806e08, 0x9d426fac786a8014}},
      {{0xddd8d5359659ed34, 0xb9a03500ed251236}},
      {{0xc18bfa7343b39f94, 0xd7f1355b51eb9203}},
      {{0x8742c786cbee4ad3, 0xcae5ca197a386594}},
      {{0xbc7d05bd6978f393, 0x886adcc677a1d3c7}},
      {{0x95901bff5e9b43dc, 0xecae2d5b30a49a02}},
      {{0xf8143ee58490452a, 0x9732f42c7d0c59db}},
      {{0x25628c97114ec3af, 0x92700d42009260d5}},
      {{0x8800803318140ab2, 0x145c3dedd23de2da}},
      {{0xbae199bfe54c9ab3, 0xb95f971aca5fcfee}},
      {{0x3f33673f2b4fc5d5, 0x71846f65403e6b40}},
      {{0x6e81c905631e8005, 0x5a04223aeff9c71a}},
      {{0xc79e073cb481fe30, 0x3e8cc64a4e942930}},
      {{0x76fe3255ae0bc709, 0x6ceb5198e7a0dfc7}},
      {{0x2dc2e9f60beee3c3, 0xabd580441f3e11e4}},
      {{0x88abf7d8608716f5, 0xdaf09b0b755bb369}},
      {{0xa706eaa41c526a0a, 0x794f5175039959a6}},
      {{0x55dd84f561d2293c, 0x27a60f85c7efa286}},
      {{0x6575752f121abd95, 0xd4f8b94cbd4ad05c}},
      {{0xb49d159e64291f12, 0x7f500ae21b1e2cf2}},
      {{0xc768f20d4b5ca78c, 0x962394b5cdd9c9f6}},
      {{0xf4b04baf4e26b3a9, 0xa4ae5a45c05c7a64}},
      {{0x8700585bdc65061b, 0x276cc4492c6f5a32}},
      {{0x823d7245cef0865d, 0xb519896c96679e8e}},
      {{0xa702c83959985ca2, 0xda25732a5b81ed20}},
      {{0x7c6c80d8f8199a8b, 0x9d51a170c8adf857}},
      {{0x59430505a1b8992d, 0x4b0d792701295149}},
      {{0x89e4e046f2d37532, 0x4526d072f36ceb1}},
      {{0x6972a153f68de573, 0x421374bff75168f0}},
      {{0x4e3503c680d7b46, 0x2c80200652c1f554}},
      {{0x6d055a3246d04b2c, 0x3b462ed6b3edb111}},
      {{0xbfb8ca167022fe8a, 0x1c28a6f00206e347}},
      {{0x97cd9ffc60844151, 0xbc7426f13465a6f3}},
      {{0xb1cc31cc41c66df, 0x5abcc8d6778fa81d}},
      {{0x11861bec287de7d, 0xb62c42754eff2d24}},
      {{0xb37e2a902d3de872, 0x24e6b1409238bf06}},
      {{0x9d3349cd2392f63e, 0x9cf350c22d2cb71d}},
      {{0xc4d809b9feb8b113, 0x7f127479de209736}},
      {{0xecec1cdab863820, 0x89c6f5610201bea5}},
      {{0x14536c3d688dc96a, 0x8bc77929f7e5b9ad}},
      {{0x51c31f93c11dfbb7, 0x855e2ffe232beccb}},
      {{0x8b82b2e99ecaa6d4, 0x58490c30b548a74a}},
      {{0x1ae8103742452080, 0xcdce30ad82c5edc9}},
      {{0xf02368b071426788, 0xb5d9335457a1fe56}},
      {{0x95401ae752bd31fb, 0xf2887198d06e1b49}},
      {{0xdc5942d9b1932176, 0x725a592ef43ea178}},
      {{0x84472e8d2edf0cf0, 0x3da199945734a4df}},
      {{0x14331bc6e3bc581f, 0x8c1b231dda83af93}},
      {{0xe995ba135667a4e9, 0x3bae32cfc0bd3c21}},
      {{0x6e04d228161bc4dc, 0xa9ce4b985fd599b9}},
      {{0x9d533b14f450688d, 0x6c32ea002fed3f88}},
      {{0x5a8b44dfa22a37de, 0x2b9a67d66d788c14}},
      {{0x307761d53a56d90, 0xf2892193dc624ee0}},
      {{0xf40a78087c257b93, 0xb61da29eae05906c}},
      {{0x90d8fbae3b5f8b7d, 0xd67ed2cd0ad99714}},
      {{0x2a4b72b9fd6fed86, 0xabc1454c969c6964}},
      {{0x798caabfb8eb60ac, 0xecf409a00493a0f6}},
      {{0x72d26b0e9c9f322, 0xfb34ada145a6c990}},
      {{0x5dea665657cd5929, 0xd749423e56f6102c}},
      {{0x3f1ad20b2c93cf9e, 0x14d16391fb47d003}},
      {{0xcefe98e52d9f8fbe, 0xc96e5fbe796c49a5}},
      {{0x60fed98f7207ee62, 0x9ad29edfd3b7fb1e}},
      {{0xc35c49bc80e6e757, 0xae72aa91259b2de2}},
      {{0x7ef067a4171b202b, 0xa2fc5e256012eeac}},
      {{0xf951e0a2abce9896, 0x17a46582af2dadd7}},
      {{0x69ca54f18fb5313, 0x89faec72d2d65f0b}},
      {{0xf58283728e1dc50d, 0xafff5219994cf2ae}},
      {{0x8b80e931c4d90326, 0x43bd6b82878d3a51}},
      {{0x76800c72dd9df832, 0x382cfa447d528051}},
      {{0x80de28559c5fcc, 0xad00dfd55abb5fd5}},
      {{0x60067d961a59fd46, 0x8f4ea432d79cc5a9}},
      {{0xfe443fd790617f30, 0x6a0811d6bc1acca3}},
      {{0x4689ac5b57fdbe5b, 0xb55347f856363b4}},
      {{0xb300f8c3bb4bcacd, 0x30aa94effd88bc15}},
      {{0x52147e6408df9943, 0x1170b3ec0a27bfe2}},
      {{0xc6aa406c738352d3, 0x21f6caa07f09b84d}},
      {{0x808267a0acdf691f, 0xa562e7f9f684c04}},
      {{0x680d260579d876c1, 0xd503bf9a0249bd27}},
      {{0xaaaa11fb4d928b38, 0xe7b4c96d80bb2656}},
      {{0x84e1ed0a3c638227, 0xa2bdf82e3ff0ca28}},
      {{0x8172906b742f5329, 0x68c5a0cfefd99663}},
      {{0x206f88e62f7201d7, 0x8b9fa7a6df7afbad}},
      {{0xe2b471b7611281e4, 0x711bffd03525b0c7}},
      {{0x24ba4806bb5987f9, 0x7c662705646d3c70}},
      {{0x4711a6a113ccdaf, 0x13c6b9d5d485bc73}},
      {{0x13670d43856ecde3, 0x6e0b99c62c83cf8c}},
      {{0xaf570911f8e3e94b, 0xa2d4a1534c0a99df}},
      {{0x86ae00601af7dd43, 0x528b8cd7484755e3}},
      {{0x1b739796c696ca66, 0x33ce7c9b5eff1523}},
      {{0xe60ca1e9e08444ae, 0xa09f7a47cd6a3e0f}},
      {{0x4c9d5b95d6b2f266, 0xfb67e0e485633f6f}},
      {{0xa10e3a71a40f8513, 0xf0127c66b965c877}},
      {{0x88cff5489cee8c47, 0x45c11eba6ecb2c21}},
      {{0x9658a1b4b1613052, 0xcb8bdd332186cc92}},
      {{0xb508bbea0b3ae7d7, 0xf27ccd0bf4501c04}},
      {{0xfdd8191264c94e04, 0x39fd7e8c876961c2}},
      {{0xde277324b4c74553, 0x201ff0d51e6a0176}},
      {{0x6dd28e2e6d8f870b, 0xbba38c6b993e3938}},
      {{0xcf34265cf57ca213, 0xa63acc0695a766b8}},
      {{0xa6f092174cbcc182, 0xb9a91f5b33e23b0c}},
      {{0x150ef310b38cf2f4, 0xd33e5de7e8909a38}},
      {{0xd35f273ff5f81f9e, 0xfc5c264db93ec210}},
      {{0xcc5d0fd2e2418370, 0x29e79a3acd73b430}},
      {{0xc9f20334e35eeae3, 0xf82a5d97e788c017}},
      {{0xdbc00f58fb0c1e5a, 0x5b1ea48a5d14592d}},
      {{0x759233a517f16396, 0xf7581115180c4a18}},
      {{0x6d3475c71cf2889b, 0x91c900ded44c753a}},
      {{0x1f3e9fcc251801e2, 0x57295fdc3bcdb95e}},
      {{0x9ee577438019ef4d, 0x4fbe8340d8eb0829}},
      {{0xff0a2767a1c8ae28, 0x2dc702dfc3cf64f5}},
      {{0xe68d7026705a249b, 0xca816fdba18914bd}},
      {{0xf4d2d8e1606883cf, 0xc29fa0c5e8f20c41}},
      {{0xe630be8e5f52182a, 0x8dac877a04b4cfa6}},
      {{0xac9b6dd4c94dc77d, 0x1f8686c075fc8129}},
      {{0x6e8d7484d4daea11, 0x3062658617bab9dd}},
      {{0xa6770d0f21dd399c, 0xe477301730c23d9e}},
      {{0x4b4105aa3b2fe844, 0x606ba68cc850357d}},
  };
#endif
  alignas(32) constexpr static std::array<uint64_t, 2> m2_transposed[128] = {
      {{0x2c8938b72774c3de, 0x36a43ac7ddf83623}},
      {{0x458dd5da4a1ec2ec, 0xe7d7bff94eadfd5}},
      {{0x7518b324b46537af, 0xd49186b8b4936ace}},
      {{0x7cc4b63799070b29, 0x5fa91012ca9924ea}},
      {{0xd799f8c674b9f13c, 0x723bab4052cc9ac3}},
      {{0xb8ee2e9149e1656, 0x19468039ee04c5ba}},
      {{0x5b94798406214797, 0x94ce8baf717b0302}},
      {{0xfaf81419a63de6bd, 0x4675c211f15108cd}},
      {{0xc1cd0be1f327b20a, 0x54d35a47faa772f7}},
      {{0x4058b717cf9dee64, 0x359fb6284f5d53d3}},
      {{0xda50b4cee5a238a5, 0x13891ed5c10f23c4}},
      {{0xa60e673878987f4c, 0xe9ad048f82bf89e7}},
      {{0x448ba5796490a31b, 0x48098124096f9831}},
      {{0xe9fbd5c1ba809fbc, 0xe394a322018e871d}},
      {{0xb44cffc80ba7ddc8, 0xb094ce3f89d7b37d}},
      {{0x181de4b5a3f4b4d1, 0xb5a6f2efe63aabd6}},
      {{0x9bac61d245a13761, 0xd0921d464cfef5ff}},
      {{0x5b52a4413f656689, 0xaa241aef3ef01fce}},
      {{0x8eae7983867c42ca, 0xd00cf8dd88a9aba7}},
      {{0x569d51b8e375d5cb, 0xf7cdf6c1c9bbfcbe}},
      {{0x3789d27cb84bb252, 0x6af5622cf3abf4c2}},
      {{0xcc8144274200e09c, 0x843163a79c0c120d}},
      {{0x2a7002469a34d70d, 0x7f372d8755be5a3e}},
      {{0x8797aaec16836e0b, 0x6131dcbe03e9daf8}},
      {{0x854ac0289274edc0, 0xd95db301f3598cb6}},
      {{0xdeb3a2c5a361746a, 0x881e822c505a2d22}},
      {{0x3a115287499318b2, 0x28717ce91e89e4e5}},
      {{0x217411f8b29cfd0, 0x9828528657b2b8df}},
      {{0xb9d104da288d1170, 0xaa39a9a6cd5f952f}},
      {{0x6747cdf055f08e8d, 0xc74fbd527dd009df}},
      {{0xaced3fdfd451eedd, 0x3e0f743a2b49c135}},
      {{0x651b30f601925e0b, 0x318fa9fb4094ea1c}},
      {{0xcbbf80afb17fb060, 0x45b140732b1c51cc}},
      {{0x4ca826c3623d69c6, 0xcba35609fe1eb96a}},
      {{0xe6a6bd65fbf7d5ae, 0x7b757928716617aa}},
      {{0xd317b91be4b182d7, 0xc84932908e49134f}},
      {{0xe96d7f9a57bdb343, 0x100fe56a220ee23c}},
      {{0x10f52b093abbb38e, 0x87151b54bae1ee9e}},
      {{0x459288d6170320c6, 0x15ea22d59a7cb0a0}},
      {{0x47dbe8115e17c7d1, 0xbc72033832960f9e}},
      {{0x240bb8a166f1df02, 0xd1ff8fbb26867702}},
      {{0xbf985e058da36b7f, 0x9dffa6881a5247e}},
      {{0xc20c082074a6d306, 0xf9eb308905af9430}},
      {{0x2ecdce0b0a572069, 0x5c4a1663d43fc38b}},
      {{0xbcb80b06e51338bb, 0x2ef0cee8aa3701c7}},
      {{0xaa5460c4af222d22, 0x3bb1abd025be5c3f}},
      {{0xd146b74fae6079fd, 0x36a088a064f34f67}},
      {{0x18121cd89e5c7a2c, 0xc40d3981c1979ca}},
      {{0xef4c8b247470a3b0, 0xf28308ab95080814}},
      {{0xe65ec1a80fa46be0, 0x555598cf5ac221e5}},
      {{0x9a025a5479828a2b, 0x62e3a8f731261398}},
      {{0x41237c14d580b83b, 0x334387f4534813ff}},
      {{0x2d05f48571a39b9b, 0x5c77752ae8201fc2}},
      {{0x460c5d5a53484b4, 0x48e4680dfe4005b0}},
      {{0x23af49f0b314d4cf, 0xc48f558b9c040fa6}},
      {{0x483b0d4157d134bb, 0x369c54a466c9f5aa}},
      {{0xa898feeabaa57721, 0x817db64b08106a78}},
      {{0xd0325c0e89f0472e, 0xebc9691f227cd6d4}},
      {{0x37878f1bfbe5d064, 0x7ff2ff36c44cb4f1}},
      {{0x793296f0067a9311, 0xb1ee3caa03044cec}},
      {{0x65eccc315133907b, 0x5d98f090034ac6b}},
      {{0x184046996b768d5c, 0x7f3056527316ad4d}},
      {{0x594902b1b1c23ff9, 0xaf3f3c30216eafa9}},
      {{0x2bd1cc4fcc9bf404, 0x5f8f6fd62ed46a83}},
      {{0x1eae9e700506a589, 0xb78c00feb957d8c0}},
      {{0x6594c16d95bb6d1, 0x48640d7eab243b48}},
      {{0x4247f515bb14daa9, 0xeb4c4a7333d92daf}},
      {{0x33bc9024245a05f3, 0xf2f8f03314423521}},
      {{0x57419bd2e0ce5d6d, 0xe377b942c219c91a}},
      {{0x990728cbce901594, 0x9baab8ecdd2e26ad}},
      {{0x83f80db1e73e85c1, 0xa5400c66ea61ca0d}},
      {{0xb62e08c4db1ec0fb, 0x6b002507302f2e98}},
      {{0x35b5e7288ff2c74e, 0xf8685c2f112b1b96}},
      {{0xa4d3cc471579b605, 0x811e0311e297502}},
      {{0xee7be94c415043fe, 0xcf2223bdcbb71e02}},
      {{0xfcee70dfc9b30616, 0x6cd8d3f3d5f55f94}},
      {{0x38c7c3372f03b5bc, 0xe26ad23ef9717163}},
      {{0x2f7eff9954ac463d, 0xe16274b0f3786f0c}},
      {{0x806805fba97ec28d, 0x93d2545148f35d4}},
      {{0x577fdf5cb559ab95, 0x38478143bd76ad5b}},
      {{0x3c6e3bbe9c58b165, 0x3c224edeb694b4b}},
      {{0x858834467634283f, 0x658379bf122d9778}},
      {{0x3ba4be5752bb1648, 0x1979314ce02279f5}},
      {{0x6998f233fe7a6991, 0x33f51c9a5bd76a86}},
      {{0x5b0060c1cefc427a, 0xbc0b92081e07972e}},
      {{0xebcdea761369f871, 0x3c837c7876a909b0}},
      {{0xf0b42b87b4502ec0, 0xd5e24efc5d88b0e2}},
      {{0x3c64331899c5a354, 0x7fc4e1898e13533e}},
      {{0x725c92e8ff42b107, 0x334f75703cdaebd0}},
      {{0x366f77cc5bd8c6bc, 0x21444c881de35967}},
      {{0xf355b8c6b7c29752, 0x382e2ebbfcdeca3d}},
      {{0xf401a05ae2d25ddb, 0x84db98df1cf5a8c3}},
      {{0x97d55b8c660beaff, 0x70f97a48b4d7b1e4}},
      {{0x611c9ac22543dc35, 0x5645c3c16c548ec1}},
      {{0xdfc5319995fafc46, 0x95ae829ed85395f0}},
      {{0x8db54295b15814aa, 0x87a7b6709a9e7945}},
      {{0x8c2728e39c2961dc, 0x4715db1eca992752}},
      {{0xc90893e844d5a656, 0x6b2ef3df1d9e59a1}},
      {{0x4f6833e5ba2a8efc, 0xe575ac75debd85a7}},
      {{0x1dad008e25db687e, 0x8b6b56880fb821a7}},
      {{0xd6d93e9089516549, 0x4b76498ea18f33e1}},
      {{0x13f2cbcc86a0805, 0x80291e016fa14b8}},
      {{0x484bfe176aada6f3, 0x1fe1d877aabd9106}},
      {{0xdaa89e80d1088c14, 0xb76c8cadb9754bdb}},
      {{0xd7ce407c3d3d398c, 0x2ad4c303f32548dc}},
      {{0x7c482e0954f04be2, 0x9bc3449071e1e7e3}},
      {{0x401b0ec290bfbcf2, 0xba4df7cc719b1d94}},
      {{0x331c1265742dcf78, 0x246f7dda7c1d798}},
      {{0xbe7c0a9ad1ab358, 0x4056cdd9a53da582}},
      {{0xecef4ff8206b3d3a, 0xe6090c7afdaada51}},
      {{0x7187b0eb09a2cadc, 0x2244af782641fce6}},
      {{0x22025416a692c219, 0x9c8a3b27bf739313}},
      {{0x865480bc8b1064b0, 0xc7625db53d086065}},
      {{0x7d2fc2c199138c9a, 0xf58eb97df1d23382}},
      {{0x182e7a2b1af941a8, 0x5d8b8e3adecaec9b}},
      {{0xddf834272999809e, 0x8cfdef1d3416f4a3}},
      {{0x654998d4661e2792, 0x4499ae5236e8775b}},
      {{0x2a00fc0bb507f28a, 0xe8c6f6204670fe9a}},
      {{0x117eca526f1ce8fe, 0xe13306aac8ea37ee}},
      {{0xdae6d10137a171b4, 0x1fa2559e9e507d4c}},
      {{0x5a6f02365a3238d6, 0x19fad5a8b36b78b4}},
      {{0xc98532aad6c6605f, 0x16d8b32f968e6f37}},
      {{0x2669ed57f18b2feb, 0x59d1208143032a6b}},
      {{0x7e379f384fd1de8a, 0x1b8f5521588fb39c}},
      {{0x8bd1be1cecfe3b02, 0x307dd66ce1308973}},
      {{0xfbc16b075bb112af, 0xe1177e7b6e55a61d}},
      {{0xa1b110a86d61637f, 0xc6dd83e56b0440ba}},
      {{0x94eea81da617ff7c, 0x4e35f372170337bf}},
  };
#ifdef INCLUDE_STANDARD_MATRICES
  constexpr static std::array<uint64_t, 2> const *matrix[2] = {
      m1,
      m2,
  };
#endif
  constexpr static std::array<uint64_t, 2> const *matrix_transposed[2] = {
      m1_transposed,
      m2_transposed,
  };

private:
  ~Params() = delete;
};

bool rain(const std::vector<uint8_t> &key_in,
          const std::vector<uint8_t> &plaintext_in,
          std::vector<uint8_t> &ciphertext_out);

std::pair<std::vector<field::GF2_128>, std::vector<field::GF2_128>>
rain_with_sbox_output(const std::vector<uint8_t> &key_in,
                      const std::vector<uint8_t> &plaintext_in,
                      std::vector<uint8_t> &ciphertext_out);

void rain_mpc(const std::vector<gsl::span<uint8_t>> &key_in,
              const std::vector<gsl::span<field::GF2_128>> &t_shares,
              const std::vector<uint8_t> &plaintext_in,
              std::vector<gsl::span<uint8_t>> &ciphertext_shares_out,
              std::vector<gsl::span<field::GF2_128>> &s_shares_out);

} // namespace RAIN_128_3
